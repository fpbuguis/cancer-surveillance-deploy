import{Q as F,T as M,d as c,p as h,l as D,o as b,e as k,b as o,u as l,w as _,F as E,m as V,Z as A,a,g as v,q as i,A as g,B as U,f as C,v as B,x as d,k as J}from"./app-42536e63.js";import{_ as u}from"./InputError-d893a523.js";import{_ as p}from"./InputLabel-ff26f500.js";import{_ as O}from"./PrimaryButton-cd95b478.js";import{_ as x}from"./TextInput-d9580142.js";import L from"./Layout-1c104a2a.js";import{d as y}from"./index-189aeacd.js";import{_ as j}from"./_plugin-vue_export-helper-c27b6911.js";import"./DropdownLink-ed97a0d6.js";/* empty css                                                               */const q={class:"mt-1 flex flex-col gap-2"},Q={class:"inline-flex items-center"},Y={class:"inline-flex items-center mt-1"},Z={class:"inline-flex items-center mt-1"},z={class:"inline-flex items-center mt-1"},G={key:0,class:"mt-3"},K={class:"mt-1 flex flex-col gap-2"},W={class:"inline-flex items-center"},X={class:"inline-flex items-center mt-1"},ee={class:"inline-flex items-center mt-1"},te={class:"inline-flex items-center"},ae={class:"inline-flex items-center mt-1"},ne={class:"inline-flex items-center mt-1"},le={class:"inline-flex items-center mt-1"},re={key:0,class:"mt-3"},oe={class:"flex items-center justify-center mt-4"},se={__name:"TreatmentHistoryPage",setup(ie){const{url:P}=F(),f=P.split("/");let s=f[f.length-1],m;s=parseInt(s,10),f.length===4&&(m=parseInt(f[2],10),s=parseInt(f[3],10)),console.log("Patient ID:",s);const t=M({lastname:"",email:"",treatment_purpose:"",other_treatment_purpose:"",primary_type:"",primary_treatment:"",initial_treatment_date:"",planned_additional_treatment:[],other_planned_additional_treatment:""}),I=c(0);c(0),h(t,r=>{console.log("Updated form:",JSON.parse(JSON.stringify(r)))},{deep:!0}),h(()=>[t.lastname,t.email],async(r,e)=>{t.lastname&&t.email&&await H()},{deep:!0}),c(null),c({lastname:"",email:""});const R=async()=>{try{const e=(await V.get("/api/all-patients")).data.find(n=>n.patient_id===s);if(console.log("Found patient:",e),e){const n=e.user;t.lastname=n.lastname,t.email=n.email}}catch(r){console.error("Failed to fetch patient info:",r)}},H=async()=>{try{const e=(await V.get("/api/find-patient",{params:{lastname:t.lastname,email:t.email}})).data;e?(s=e.patient_id,console.log(s),console.log(m)):console.log("Failed to fetch patient ID")}catch(r){console.log("Failed to fetch patient ID:",r)}},T=(r,e)=>{console.log(r);const n=r.rxtypes[e];n&&(n.rxtype_chemotherapy===1&&t.planned_additional_treatment.push("Chemotherapy"),n.rxtype_hormonaltherapy===1&&t.planned_additional_treatment.push("Hormonal Therapy"),n.rxtype_immunotherapy===1&&t.planned_additional_treatment.push("Immunotherapy/Cryotherapy"),n.rxtype_radiotherapy===1&&t.planned_additional_treatment.push("Radiotherapy"),n.rxtype_surgery===1&&t.planned_additional_treatment.push("Surgery"),n.rxtype_others===1&&t.planned_additional_treatment.push("Others"))},N=async r=>{try{const n=(await V.get(`/api/patient/${r}/treatments`)).data;t.treatment_purpose=n.treatments[m].treatment_purpose,console.log("Treatment Info:",n),t.treatment_purpose==="Others"&&(t.other_treatment_purpose=n.treatments[m].treatment_other_purpose),t.primary_type=n.treatments[m].treatment_primaryRxType,t.primary_treatment=n.treatments[m].treatment_primaryRxName,t.initial_treatment_date=n.treatments[m].treatment_initialRxDate,T(n,m),t.planned_additional_treatment.includes("Others")&&(t.other_planned_additional_treatment=n.rxtypes[m].rxtype_other_treatment),console.log(n)}catch(e){console.error("Failed to fetch patient:",e)}};D(async()=>{await R(),await N(s),T(m)});const S=c(0),$=()=>{console.log(t),t.post("/api/create-treatment-record",{onSuccess:()=>{console.log("Success"),S.value===1?y.Inertia.visit("/treatment-history"):t.primary_type?(console.log(s),w()):y.Inertia.visit("/consult")},onError:r=>{r.patient_id?error.value=r.patient_id[0]:console.log(r)}})},w=()=>{if(I.value===0&&t.primary_type){I.value++;const r={currentStep:1,treatment:t.primary_type};switch(console.log(t.primary_type),console.log(s),t.primary_type){case"Radiotherapy":y.Inertia.visit(`/treatment-history/radiotherapy/${s}`,{data:r});break;case"Chemotherapy":y.Inertia.visit(`/treatment-history/chemotherapy/${s}`,{data:r});break;case"Surgery":y.Inertia.visit(`/treatment-history/surgery/${s}`,{data:r});break;case"Immunotherapy/Cryotherapy":y.Inertia.visit(`/treatment-history/immunotherapy/${s}`,{data:r});break;case"Hormonal":y.Inertia.visit(`/treatment-history/hormonal/${s}`,{data:r});break}}};return h(t,r=>{console.log("Updated form:",JSON.parse(JSON.stringify(r)))},{deep:!0}),(r,e)=>(b(),k(E,null,[o(l(A),{title:"Treatment History"}),o(L,null,{default:_(()=>[e[40]||(e[40]=a("div",{class:"page-heading"},[a("h1",{class:"main-heading"},"TREATMENT HISTORY")],-1)),a("form",{onSubmit:J($,["prevent"]),class:"form-container"},[a("div",null,[o(p,{for:"lastname"},{default:_(()=>e[19]||(e[19]=[v(" Last Name "),a("span",{class:"red-asterisk"},"*",-1)])),_:1}),o(x,{id:"lastname",modelValue:l(t).lastname,"onUpdate:modelValue":e[0]||(e[0]=n=>l(t).lastname=n),type:"text",class:"mt-1 block w-full",autofocus:"",autocomplete:"lastname"},null,8,["modelValue"]),o(u,{class:"mt-2",message:l(t).errors.lastname},null,8,["message"])]),a("div",null,[o(p,{for:"email"},{default:_(()=>e[20]||(e[20]=[v(" Email Address "),a("span",{class:"red-asterisk"},"*",-1)])),_:1}),o(x,{id:"email",modelValue:l(t).email,"onUpdate:modelValue":e[1]||(e[1]=n=>l(t).email=n),type:"email",class:"mt-1 block w-full",autocomplete:"username"},null,8,["modelValue"]),o(u,{class:"mt-2",message:l(t).errors.email},null,8,["message"])]),a("div",null,[o(p,{for:"treatment_purpose",value:"Treatment Purpose"}),a("div",q,[a("label",Q,[i(a("input",{type:"radio",name:"treatment_purpose",value:"Curative-complete","onUpdate:modelValue":e[2]||(e[2]=n=>l(t).treatment_purpose=n),class:"form-radio"},null,512),[[g,l(t).treatment_purpose]]),e[21]||(e[21]=a("span",{class:"custom-radio"},null,-1)),e[22]||(e[22]=a("span",{class:"ml-2"},"Curative-complete",-1))]),a("label",Y,[i(a("input",{type:"radio",name:"treatment_purpose",value:"Curative-incomplete","onUpdate:modelValue":e[3]||(e[3]=n=>l(t).treatment_purpose=n),class:"form-radio"},null,512),[[g,l(t).treatment_purpose]]),e[23]||(e[23]=a("span",{class:"custom-radio"},null,-1)),e[24]||(e[24]=a("span",{class:"ml-2"},"Curative-incomplete",-1))]),a("label",Z,[i(a("input",{type:"radio",name:"treatment_purpose",value:"Palliative only","onUpdate:modelValue":e[4]||(e[4]=n=>l(t).treatment_purpose=n),class:"form-radio"},null,512),[[g,l(t).treatment_purpose]]),e[25]||(e[25]=a("span",{class:"custom-radio"},null,-1)),e[26]||(e[26]=a("span",{class:"ml-2"},"Palliative only",-1))]),a("label",z,[i(a("input",{type:"radio",name:"treatment_purpose",value:"Others","onUpdate:modelValue":e[5]||(e[5]=n=>l(t).treatment_purpose=n),class:"form-radio"},null,512),[[g,l(t).treatment_purpose]]),e[27]||(e[27]=a("span",{class:"custom-radio"},null,-1)),e[28]||(e[28]=a("span",{class:"ml-2"},"Others",-1))])]),l(t).treatment_purpose.includes("Others")?(b(),k("div",G,[o(p,{for:"other_treatment_purpose",value:"Specify"}),i(a("input",{id:"other_treatment_purpose","onUpdate:modelValue":e[6]||(e[6]=n=>l(t).other_treatment_purpose=n),type:"text",class:"mt-1 block w-full",placeholder:"Specify treatment purpose"},null,512),[[U,l(t).other_treatment_purpose]])])):C("",!0),o(u,{class:"mt-2",message:l(t).errors.treatment_purpose},null,8,["message"])]),a("div",null,[o(p,{for:"primary_type",value:"Primary Type"}),i(a("select",{id:"primary_type","onUpdate:modelValue":e[7]||(e[7]=n=>l(t).primary_type=n),class:"mt-1 block w-full"},e[29]||(e[29]=[a("option",{value:"",disabled:""},"Select Primary Type",-1),a("option",{value:"Surgery"},"Surgery",-1),a("option",{value:"Radiotherapy"},"Radiotherapy",-1),a("option",{value:"Chemotherapy"},"Chemotherapy",-1),a("option",{value:"Immunotherapy/Cryotherapy"},"Immunotherapy/Cryotherapy",-1),a("option",{value:"Hormonal Therapy"},"Hormonal Therapy",-1),a("option",{value:"Unknown"},"Unknown",-1)]),512),[[B,l(t).primary_type]]),o(u,{message:l(t).errors.primary_type},null,8,["message"])]),a("div",null,[o(p,{for:"primary_treatment"},{default:_(()=>e[30]||(e[30]=[v(" Primary Treatment ")])),_:1}),o(x,{id:"primary_treatment",modelValue:l(t).primary_treatment,"onUpdate:modelValue":e[8]||(e[8]=n=>l(t).primary_treatment=n),type:"primary_treatment",class:"mt-1 block w-full"},null,8,["modelValue"]),o(u,{class:"mt-2",message:l(t).errors.primary_treatment},null,8,["message"])]),a("div",null,[o(p,{for:"initial_treatment_date",value:"Initial Treatment Date"}),o(x,{id:"initial_treatment_date",modelValue:l(t).initial_treatment_date,"onUpdate:modelValue":e[9]||(e[9]=n=>l(t).initial_treatment_date=n),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),o(u,{class:"mt-2",message:l(t).errors.initial_treatment_date},null,8,["message"])]),a("div",null,[o(p,{for:"planned_additional_treatment",value:"Planned Additional Treatment"}),a("div",K,[a("label",W,[i(a("input",{type:"checkbox",value:"Surgery","onUpdate:modelValue":e[10]||(e[10]=n=>l(t).planned_additional_treatment=n),class:"form-checkbox"},null,512),[[d,l(t).planned_additional_treatment]]),e[31]||(e[31]=a("span",{class:"ml-2"},"Surgery",-1))]),a("label",X,[i(a("input",{type:"checkbox",value:"Radiotherapy","onUpdate:modelValue":e[11]||(e[11]=n=>l(t).planned_additional_treatment=n),class:"form-checkbox"},null,512),[[d,l(t).planned_additional_treatment]]),e[32]||(e[32]=a("span",{class:"ml-2"},"Radiotherapy",-1))]),a("label",ee,[i(a("input",{type:"checkbox",value:"Chemotherapy","onUpdate:modelValue":e[12]||(e[12]=n=>l(t).planned_additional_treatment=n),class:"form-checkbox"},null,512),[[d,l(t).planned_additional_treatment]]),e[33]||(e[33]=a("span",{class:"ml-2"},"Chemotherapy",-1))]),a("label",te,[i(a("input",{type:"checkbox",value:"Immunotherapy/Cryotherapy","onUpdate:modelValue":e[13]||(e[13]=n=>l(t).planned_additional_treatment=n),class:"form-checkbox"},null,512),[[d,l(t).planned_additional_treatment]]),e[34]||(e[34]=a("span",{class:"ml-2"},"Immunotherapy/Cryotherapy",-1))]),a("label",ae,[i(a("input",{type:"checkbox",value:"Hormonal Therapy","onUpdate:modelValue":e[14]||(e[14]=n=>l(t).planned_additional_treatment=n),class:"form-checkbox"},null,512),[[d,l(t).planned_additional_treatment]]),e[35]||(e[35]=a("span",{class:"ml-2"},"Hormonal Therapy",-1))]),a("label",ne,[i(a("input",{type:"checkbox",value:"Unknown","onUpdate:modelValue":e[15]||(e[15]=n=>l(t).planned_additional_treatment=n),class:"form-checkbox"},null,512),[[d,l(t).planned_additional_treatment]]),e[36]||(e[36]=a("span",{class:"ml-2"},"Unknown",-1))]),a("label",le,[i(a("input",{type:"checkbox",value:"Others","onUpdate:modelValue":e[16]||(e[16]=n=>l(t).planned_additional_treatment=n),class:"form-checkbox"},null,512),[[d,l(t).planned_additional_treatment]]),e[37]||(e[37]=a("span",{class:"ml-2"},"Others",-1))])]),l(t).planned_additional_treatment.includes("Others")?(b(),k("div",re,[o(p,{for:"other_planned_additional_treatment",value:"Specify"}),i(a("input",{id:"other_planned_additional_treatment","onUpdate:modelValue":e[17]||(e[17]=n=>l(t).other_planned_additional_treatment=n),type:"text",class:"mt-1 block w-full",placeholder:"Specify other planned additional treatment"},null,512),[[U,l(t).other_planned_additional_treatment]])])):C("",!0),o(u,{class:"mt-2",message:l(t).errors.planned_additional_treatment},null,8,["message"])]),a("div",oe,[o(O,{onClick:e[18]||(e[18]=n=>S.value=1),class:"ms-4"},{default:_(()=>e[38]||(e[38]=[v(" Submit ")])),_:1}),o(O,{onClick:w,class:"ms-4"},{default:_(()=>e[39]||(e[39]=[v(" Submit and Proceed ")])),_:1})])],32)]),_:1})],64))}},xe=j(se,[["__scopeId","data-v-57ccf364"]]);export{xe as default};
