import{Q as q,T as A,d as v,l as h,m as b,o as u,c as C,w as m,a as r,b as a,g as y,u as l,q as f,A as w,e as _,B as j,f as S,v as R,t as I,h as F,F as O,k as G}from"./app-42536e63.js";import{_ as g}from"./InputError-d893a523.js";import{_ as d}from"./InputLabel-ff26f500.js";import{_ as k}from"./TextInput-d9580142.js";import H from"./Layout-1c104a2a.js";import{_ as $}from"./PrimaryButton-cd95b478.js";import{d as P}from"./index-189aeacd.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";import"./DropdownLink-ed97a0d6.js";/* empty css                                                               */const Y={class:"mt-1 flex flex-col gap-2"},z={class:"inline-flex items-center"},J={class:"inline-flex items-center mt-1"},K={class:"inline-flex items-center mt-1"},W={class:"inline-flex items-center mt-1"},X={key:0,class:"mt-3"},Z=["disabled"],ee={value:"",disabled:"",selected:""},se=["value"],te={key:0,class:"mt-2 text-sm text-red-600"},re=["value"],le={class:"flex items-center justify-center mt-4"},ae={__name:"SurgeryPage",setup(oe){const{url:x}=q(),c=x.split("/");let n=c[c.length-1];n=parseInt(n,10),console.log("Patient ID:",n);let i;c.length===5&&(i=parseInt(c[3],10),n=parseInt(c[4],10));const t=A({lastname:"",email:"",surgery_operation:"",surgery_date:"",surgery_findings:"",surgery_intent:"",surgery_otherIntent:"",surgery_surgeon:"",surgery_hospital:""}),V=v(0),L=v([]),B=v([]),U=v(null),D=v(0);if(x){const o=new URL(x,window.location.origin);V.value=o.searchParams.get("currentStep")}else console.error("URL is undefined");const E=()=>{P.Inertia.visit(document.referrer)},M=async()=>{try{const s=(await b.get("/api/all-patients")).data.find(p=>p.patient_id===n);if(console.log("Found patient:",s),s){const p=s.user;t.lastname=p.lastname,t.email=p.email}}catch(o){console.error("Failed to fetch patient info:",o)}},N=async o=>{try{const s=(await b.get(`/api/patient/${o}/treatments`)).data;console.log(s),t.surgery_operation=s.surgeries[i].surgery_operation,t.surgery_date=s.surgeries[i].surgery_date,t.surgery_findings=s.surgeries[i].surgery_findings,t.surgery_intent=s.surgeries[i].surgery_intent,t.surgery_intent==="Others"&&(t.surgery_otherIntent=s.treatments[i].surgery_otherIntent),t.surgery_surgeon=s.surgeries[i].surgery_surgeon,t.surgery_hospital=s.surgeries[i].surgery_hospital}catch(e){console.error("Failed to fetch patient:",e)}};h(async()=>{await M(),await N(n),console.log(n),console.log(i);try{const[o,e]=await Promise.all([b.get("/api/all-doctors"),b.get("/api/hospitals")]);L.value=o.data,B.value=e.data}catch(o){console.error("Error loading initial data:",o)}});const T=()=>{t.post("/api/create-surgery-record",{onSuccess:()=>{D.value===1?P.Inertia.visit(`/treatment-history/surgery/${n}`):V.value?P.Inertia.visit(`/consult/${n}`):window.location.href=`/treatment-history/radiotherapy/${n}`},onError:o=>{o.patient_id?U.value=o.patient_id[0]:console.log(o)}})};return(o,e)=>(u(),C(H,null,{default:m(()=>[e[29]||(e[29]=r("div",{class:"page-heading"},[r("h1",{class:"main-heading"},"SURGERY")],-1)),r("form",{onSubmit:G(T,["prevent"]),class:"form-container"},[r("div",null,[a(d,{for:"lastname"},{default:m(()=>e[13]||(e[13]=[y(" Last Name "),r("span",{class:"red-asterisk"},"*",-1)])),_:1}),a(k,{id:"lastname",modelValue:l(t).lastname,"onUpdate:modelValue":e[0]||(e[0]=s=>l(t).lastname=s),type:"text",class:"mt-1 block w-full",autofocus:"",autocomplete:"lastname"},null,8,["modelValue"]),a(g,{class:"mt-2",message:l(t).errors.lastname},null,8,["message"])]),r("div",null,[a(d,{for:"email"},{default:m(()=>e[14]||(e[14]=[y(" Email Address "),r("span",{class:"red-asterisk"},"*",-1)])),_:1}),a(k,{id:"email",modelValue:l(t).email,"onUpdate:modelValue":e[1]||(e[1]=s=>l(t).email=s),type:"email",class:"mt-1 block w-full",autocomplete:"username"},null,8,["modelValue"]),a(g,{class:"mt-2",message:l(t).errors.email},null,8,["message"])]),r("div",null,[a(d,{for:"surgery_operation",value:"Surgery Operation"}),a(k,{id:"surgery_operation",modelValue:l(t).surgery_operation,"onUpdate:modelValue":e[2]||(e[2]=s=>l(t).surgery_operation=s),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),a(g,{message:l(t).errors.surgery_operation},null,8,["message"])]),r("div",null,[a(d,{for:"surgery_date",value:"Surgery Date"}),a(k,{id:"surgery_date",modelValue:l(t).surgery_date,"onUpdate:modelValue":e[3]||(e[3]=s=>l(t).surgery_date=s),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),a(g,{class:"mt-2",message:l(t).errors.surgery_date},null,8,["message"])]),r("div",null,[a(d,{for:"surgery_findings",value:"Surgery Findings"}),a(k,{id:"surgery_findings",modelValue:l(t).surgery_findings,"onUpdate:modelValue":e[4]||(e[4]=s=>l(t).surgery_findings=s),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),a(g,{class:"mt-2",message:l(t).errors.surgery_findings},null,8,["message"])]),r("div",null,[a(d,{for:"surgery_intent",value:"Surgery Intent"}),r("div",Y,[r("label",z,[f(r("input",{type:"radio",name:"treatment_purpose",value:"Curative-complete","onUpdate:modelValue":e[5]||(e[5]=s=>l(t).surgery_intent=s),class:"form-radio"},null,512),[[w,l(t).surgery_intent]]),e[15]||(e[15]=r("span",{class:"custom-radio"},null,-1)),e[16]||(e[16]=r("span",{class:"ml-2"},"Curative-complete",-1))]),r("label",J,[f(r("input",{type:"radio",name:"treatment_purpose",value:"Curative-incomplete","onUpdate:modelValue":e[6]||(e[6]=s=>l(t).surgery_intent=s),class:"form-radio"},null,512),[[w,l(t).surgery_intent]]),e[17]||(e[17]=r("span",{class:"custom-radio"},null,-1)),e[18]||(e[18]=r("span",{class:"ml-2"},"Curative-incomplete",-1))]),r("label",K,[f(r("input",{type:"radio",name:"treatment_purpose",value:"Palliative only","onUpdate:modelValue":e[7]||(e[7]=s=>l(t).surgery_intent=s),class:"form-radio"},null,512),[[w,l(t).surgery_intent]]),e[19]||(e[19]=r("span",{class:"custom-radio"},null,-1)),e[20]||(e[20]=r("span",{class:"ml-2"},"Palliative only",-1))]),r("label",W,[f(r("input",{type:"radio",name:"treatment_purpose",value:"Others","onUpdate:modelValue":e[8]||(e[8]=s=>l(t).surgery_intent=s),class:"form-radio"},null,512),[[w,l(t).surgery_intent]]),e[21]||(e[21]=r("span",{class:"custom-radio"},null,-1)),e[22]||(e[22]=r("span",{class:"ml-2"},"Others",-1))])]),l(t).surgery_intent==="Others"?(u(),_("div",X,[a(d,{for:"surgery_otherIntent",value:"Specify"}),f(r("input",{id:"surgery_otherIntent","onUpdate:modelValue":e[9]||(e[9]=s=>l(t).surgery_otherIntent=s),type:"text",class:"mt-1 block w-full",placeholder:"Specify surgery intent"},null,512),[[j,l(t).surgery_otherIntent]])])):S("",!0),a(g,{class:"mt-2",message:l(t).errors.treatment_purpose},null,8,["message"])]),r("div",null,[a(d,{for:"surgery_surgeon"},{default:m(()=>e[23]||(e[23]=[y(" Surgery Doctor "),r("span",{class:"red-asterisk"},"*",-1)])),_:1}),f(r("select",{id:"surgery_surgeon","onUpdate:modelValue":e[10]||(e[10]=s=>l(t).surgery_surgeon=s),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:"",disabled:o.isLoading},[r("option",ee,I(o.isLoading?"Loading doctors...":"Select a Doctor"),1),(u(!0),_(O,null,F(L.value,s=>(u(),_("option",{key:s.doctor_id,value:s.doctor_id},I("Dr. "+`${s.user.firstname} ${s.user.middlename} ${s.user.lastname}`.toLowerCase().split(" ").map(p=>p.charAt(0).toUpperCase()+p.slice(1)).join(" ")),9,se))),128))],8,Z),[[R,l(t).surgery_surgeon]]),a(g,{class:"mt-2",message:l(t).errors.surgery_surgeon},null,8,["message"]),U.value?(u(),_("p",te,I(U.value),1)):S("",!0)]),r("div",null,[a(d,{for:"surgery_hospital"},{default:m(()=>e[24]||(e[24]=[y(" Surgery Hospital "),r("span",{class:"red-asterisk"},"*",-1)])),_:1}),f(r("select",{id:"surgery_hospital","onUpdate:modelValue":e[11]||(e[11]=s=>l(t).surgery_hospital=s),class:"mt-1 block w-full",required:""},[e[25]||(e[25]=r("option",{value:"",disabled:""},"Select hospital",-1)),(u(!0),_(O,null,F(B.value,s=>(u(),_("option",{key:s.hospital_id,value:s.hospital_id},I(s.hospital_name),9,re))),128))],512),[[R,l(t).surgery_hospital]]),a(g,{class:"mt-2",message:l(t).errors.surgery_hospital},null,8,["message"])]),r("div",le,[V.value?(u(),C($,{key:0,onClick:E,class:"ms-4"},{default:m(()=>e[26]||(e[26]=[y(" Back ")])),_:1})):S("",!0),V.value?S("",!0):(u(),C($,{key:1,onClick:e[12]||(e[12]=s=>D.value=1),class:"ms-4"},{default:m(()=>e[27]||(e[27]=[y(" Submit ")])),_:1})),a($,{onClick:o.nextStep,class:"ms-4"},{default:m(()=>e[28]||(e[28]=[y(" Submit and Proceed ")])),_:1},8,["onClick"])])],32)]),_:1}))}},ce=Q(ae,[["__scopeId","data-v-5912f751"]]);export{ce as default};
