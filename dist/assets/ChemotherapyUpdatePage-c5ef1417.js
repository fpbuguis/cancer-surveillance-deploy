import{Q as M,d as y,T as B,l as O,m as c,o as d,c as P,w as h,a as s,b as l,g,u as a,q as f,v as w,e as _,h as k,t as V,F as U,A as $,f as E,k as q}from"./app-42536e63.js";import{_ as i}from"./InputError-d893a523.js";import{_ as r}from"./InputLabel-ff26f500.js";import{_ as v}from"./TextInput-d9580142.js";import Y from"./Layout-1c104a2a.js";import{A as G}from"./Alert-e9943a8b.js";import{_ as Q}from"./PrimaryButton-cd95b478.js";import{d as z}from"./index-189aeacd.js";import{_ as J}from"./_plugin-vue_export-helper-c27b6911.js";import"./DropdownLink-ed97a0d6.js";/* empty css                                                               */const K=["value"],W={class:"mt-1 flex flex-col gap-2"},X={class:"inline-flex items-center"},Z={class:"inline-flex items-center"},ee=["value"],te=["disabled"],oe={value:"",disabled:"",selected:""},se=["value"],ae={key:0,class:"mt-2 text-sm text-red-600"},le={class:"flex items-center justify-center mt-4"},me={__name:"ChemotherapyUpdatePage",setup(ie){const{url:D,props:N}=M(),C=D.split("/");let u=C[C.length-1];u=parseInt(u,10),console.log("Patient ID:",u);let n;C.length===4&&(n=parseInt(C[2],10),u=parseInt(C[3],10));const L=N.auth.user.user_id,T=N.auth.user.email,b=y({show:!1,message:"",type:""}),o=B({lastname:"",email:"",chemo_type:"",chemotherapy_given:"",chemo_initialDate:"",chemo_endDate:"",chemo_cycleNumber:"",chemo_status:"",chemo_notes:"",chemo_isCompleted:Boolean,chemo_facility:"",chemo_doctor:""}),A=y(0),I=y([]),S=y([]),x=y([]),R=y(0);if(D){const m=new URL(D,window.location.origin);A.value=m.searchParams.get("currentStep")}else console.error("URL is undefined");const j=async()=>{try{const t=(await c.get("/api/all-patients")).data.find(p=>p.patient_id===u);if(console.log("Found patient:",t),t){const p=t.user;o.lastname=p.lastname,o.email=p.email}}catch(m){console.error("Failed to fetch patient info:",m)}},F=async m=>{try{const t=(await c.get(`/api/patient/${m}/treatments`)).data;console.log(t),o.chemo_type=t.chemotherapies[n].chemo_type,o.chemotherapy_given=t.chemotherapies[n].chemo_protocol,o.chemo_initialDate=t.chemotherapies[n].chemo_initial_date,o.chemo_endDate=t.chemotherapies[n].chemo_end_date,o.chemo_cycleNumber=t.chemotherapies[n].chemo_cycleNumGiven,o.chemo_status=t.chemotherapies[n].chemo_status,o.chemo_notes=t.chemotherapies[n].chemo_notes,o.chemo_isCompleted=t.chemotherapies[n].chemo_isCompleted===1,o.chemo_facility=t.chemotherapies[n].chemo_facility,o.chemo_doctor=t.chemotherapies[n].chemo_doctor}catch(e){console.error("Failed to fetch patient:",e)}};O(async()=>{await j(),await F(u);try{const[m,e,t]=await Promise.all([c.get("/api/all-doctors"),c.get("/api/hospitals"),c.get("/api/chemoprotocols")]);console.log("Doctors:",m.data),console.log("Hospitals:",e.data),console.log("Chemoprotocols:",t.data),I.value=m.data,S.value=e.data,x.value=t.data}catch(m){console.error("Error loading initial data:",m)}});const H=async()=>{try{b.value.show=!1,console.log(o);const m=await c.put(`/api/treatment/update/chemotherapy/${u}`,o),e=await c.get(`/api/get-patient/${u}`);await c.post("/api/create-notification-log",{from:T,to:e.data.user.email,subject:"Treatment Information Updated",message:"The patient's CHEMOTHERAPY treatment is updated",senderId:L,receiverId:e.data.user.user_id,notificationStatus:1,notificationType:5}),m.status===200?(b.value={show:!0,message:"Success! Chemotherapy details updated.",type:"success"},z.Inertia.get("/search")):console.error("Error updating details:",m.status)}catch(m){console.error("Error updating details:",m)}};return(m,e)=>(d(),P(Y,null,{default:h(()=>[e[28]||(e[28]=s("div",{class:"page-heading"},[s("h1",{class:"main-heading"},"CHEMOTHERAPHY")],-1)),s("form",{onSubmit:q(H,["prevent"]),class:"form-container"},[s("div",null,[l(r,{for:"lastname"},{default:h(()=>e[14]||(e[14]=[g(" Last Name "),s("span",{class:"red-asterisk"},"*",-1)])),_:1}),l(v,{id:"lastname",modelValue:a(o).lastname,"onUpdate:modelValue":e[0]||(e[0]=t=>a(o).lastname=t),type:"text",class:"mt-1 block w-full",autofocus:"",autocomplete:"lastname",disabled:""},null,8,["modelValue"]),l(i,{class:"mt-2",message:a(o).errors.lastname},null,8,["message"])]),s("div",null,[l(r,{for:"email"},{default:h(()=>e[15]||(e[15]=[g(" Email Address "),s("span",{class:"red-asterisk"},"*",-1)])),_:1}),l(v,{id:"email",modelValue:a(o).email,"onUpdate:modelValue":e[1]||(e[1]=t=>a(o).email=t),type:"email",class:"mt-1 block w-full",autocomplete:"username",disabled:""},null,8,["modelValue"]),l(i,{class:"mt-2",message:a(o).errors.email},null,8,["message"])]),s("div",null,[l(r,{for:"chemo_type",value:"Chemotherapy Type"}),f(s("select",{id:"chemo_type","onUpdate:modelValue":e[2]||(e[2]=t=>a(o).chemo_type=t),class:"mt-1 block w-full"},e[16]||(e[16]=[s("option",{value:"",disabled:""},"Select Chemotherapy Type",-1),s("option",{value:"Neoadjuvant"},"Neoadjuvant",-1),s("option",{value:"Adjuvant"},"Adjuvant",-1),s("option",{value:"Palliative"},"Palliative",-1)]),512),[[w,a(o).chemo_type]]),l(i,{message:a(o).errors.chemo_type},null,8,["message"])]),s("div",null,[l(r,{for:"chemotherapy_given"},{default:h(()=>e[17]||(e[17]=[g(" Chemotherapy Given ")])),_:1}),f(s("select",{id:"chemotherapy_given","onUpdate:modelValue":e[3]||(e[3]=t=>a(o).chemotherapy_given=t),class:"mt-1 block w-full",required:""},[e[18]||(e[18]=s("option",{value:"",disabled:""},"Select Chemotheraphy",-1)),(d(!0),_(U,null,k(x.value,t=>(d(),_("option",{key:t.chemo_protocol_id,value:t.chemo_protocol_id},V(t.chemo_drugs),9,K))),128))],512),[[w,a(o).chemotherapy_given]]),l(i,{class:"mt-2",message:a(o).errors.chemotherapy_given},null,8,["message"])]),s("div",null,[l(r,{for:"chemo_initialDate",value:"Initial Chemotherapy Date"}),l(v,{id:"chemo_initialDate",modelValue:a(o).chemo_initialDate,"onUpdate:modelValue":e[4]||(e[4]=t=>a(o).chemo_initialDate=t),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),l(i,{class:"mt-2",message:a(o).errors.chemo_initialDate},null,8,["message"])]),s("div",null,[l(r,{for:"chemo_endDate",value:"Last Chemotherapy Date"}),l(v,{id:"chemo_endDate",modelValue:a(o).chemo_endDate,"onUpdate:modelValue":e[5]||(e[5]=t=>a(o).chemo_endDate=t),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),l(i,{class:"mt-2",message:a(o).errors.chemo_endDate},null,8,["message"])]),s("div",null,[l(r,{for:"chemo_cycleNumber",value:"Chemotherapy No. of Cycles"}),l(v,{id:"chemo_cycleNumber",modelValue:a(o).chemo_cycleNumber,"onUpdate:modelValue":e[6]||(e[6]=t=>a(o).chemo_cycleNumber=t),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),l(i,{class:"mt-2",message:a(o).errors.chemo_cycleNumber},null,8,["message"])]),s("div",null,[l(r,{for:"chemo_status",value:"Chemotherapy Status"}),f(s("select",{id:"chemo_status","onUpdate:modelValue":e[7]||(e[7]=t=>a(o).chemo_status=t),class:"mt-1 block w-full"},e[19]||(e[19]=[s("option",{value:"",disabled:""},"Select Chemotherapy Status",-1),s("option",{value:"Ongoing"},"Ongoing",-1),s("option",{value:"Completed"},"Completed",-1),s("option",{value:"Not Completed"},"Not Completed",-1)]),512),[[w,a(o).chemo_status]]),l(i,{class:"mt-2",message:a(o).errors.chemo_status},null,8,["message"])]),s("div",null,[l(r,{for:"chemo_notes",value:"Chemotherapy Notes"}),l(v,{id:"chemo_notes",modelValue:a(o).chemo_notes,"onUpdate:modelValue":e[8]||(e[8]=t=>a(o).chemo_notes=t),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),l(i,{class:"mt-2",message:a(o).errors.chemo_notes},null,8,["message"])]),s("div",null,[l(r,{for:"chemo_isCompleted",value:"Chemotheraphy Completed"}),s("div",W,[s("label",X,[f(s("input",{type:"radio",name:"chemo_isCompleted",value:!0,"onUpdate:modelValue":e[9]||(e[9]=t=>a(o).chemo_isCompleted=t),class:"form-radio"},null,512),[[$,a(o).chemo_isCompleted]]),e[20]||(e[20]=s("span",{class:"custom-radio"},null,-1)),e[21]||(e[21]=s("span",{class:"ml-2"},"Yes",-1))]),s("label",Z,[f(s("input",{type:"radio",name:"chemo_isCompleted",value:!1,"onUpdate:modelValue":e[10]||(e[10]=t=>a(o).chemo_isCompleted=t),class:"form-radio"},null,512),[[$,a(o).chemo_isCompleted]]),e[22]||(e[22]=s("span",{class:"custom-radio"},null,-1)),e[23]||(e[23]=s("span",{class:"ml-2"},"No",-1))])]),l(i,{class:"mt-2",message:a(o).errors.chemo_isCompleted},null,8,["message"])]),s("div",null,[l(r,{for:"chemo_facility"},{default:h(()=>e[24]||(e[24]=[g(" Chemotherapy Facility ")])),_:1}),f(s("select",{id:"chemo_facility","onUpdate:modelValue":e[11]||(e[11]=t=>a(o).chemo_facility=t),class:"mt-1 block w-full",required:""},[e[25]||(e[25]=s("option",{value:"",disabled:""},"Select facility",-1)),(d(!0),_(U,null,k(S.value,t=>(d(),_("option",{key:t.hospital_id,value:t.hospital_id},V(t.hospital_name),9,ee))),128))],512),[[w,a(o).chemo_facility]]),l(i,{class:"mt-2",message:a(o).errors.chemo_facility},null,8,["message"])]),s("div",null,[l(r,{for:"chemo_doctor"},{default:h(()=>e[26]||(e[26]=[g(" Chemotherapy Doctor ")])),_:1}),f(s("select",{id:"chemo_doctor","onUpdate:modelValue":e[12]||(e[12]=t=>a(o).chemo_doctor=t),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:"",disabled:m.isLoading},[s("option",oe,V(m.isLoading?"Loading doctors...":"Select a Doctor"),1),(d(!0),_(U,null,k(I.value,t=>(d(),_("option",{key:t.doctor_id,value:t.doctor_id},V("Dr. "+`${t.user.firstname} ${t.user.middlename} ${t.user.lastname}`.toLowerCase().split(" ").map(p=>p.charAt(0).toUpperCase()+p.slice(1)).join(" ")),9,se))),128))],8,te),[[w,a(o).chemo_doctor]]),l(i,{class:"mt-2",message:a(o).errors.chemo_doctor},null,8,["message"]),m.error?(d(),_("p",ae,V(m.error),1)):E("",!0)]),s("div",le,[l(Q,{onClick:e[13]||(e[13]=t=>R.value=1),class:"ms-4"},{default:h(()=>e[27]||(e[27]=[g(" Update Details ")])),_:1})])],32),b.value.show?(d(),P(G,{key:0,message:b.value.message,type:b.value.type},null,8,["message","type"])):E("",!0)]),_:1}))}},ve=J(me,[["__scopeId","data-v-1f4ab3d4"]]);export{ve as default};
