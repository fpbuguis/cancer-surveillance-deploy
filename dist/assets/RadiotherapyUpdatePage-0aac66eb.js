import{Q as q,d as c,T as M,l as O,m as p,o as u,c as P,w as _,a as s,b as o,g as x,u as l,q as y,v as V,e as f,h as S,t as w,F as C,A as $,f as A,k as j}from"./app-42536e63.js";import{_ as d}from"./InputError-d893a523.js";import{_ as i}from"./InputLabel-ff26f500.js";import{_ as g}from"./TextInput-d9580142.js";import{_ as H}from"./PrimaryButton-cd95b478.js";import{A as Y}from"./Alert-e9943a8b.js";import Q from"./Layout-1c104a2a.js";import{d as z}from"./index-189aeacd.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";import"./DropdownLink-ed97a0d6.js";/* empty css                                                               */const J=["value"],K={class:"mt-1 flex flex-col gap-2"},W={class:"inline-flex items-center"},X={class:"inline-flex items-center"},Z=["value"],ee=["disabled"],ae={value:"",disabled:"",selected:""},te=["value"],se={key:0,class:"mt-2 text-sm text-red-600"},le={class:"flex items-center justify-center mt-4"},oe={__name:"RadiotherapyUpdatePage",setup(re){const{url:k,props:D}=q(),v=k.split("/");let m=v[v.length-1];m=parseInt(m,10),console.log("Patient ID:",m);let n;v.length===4&&(n=parseInt(v[2],10),m=parseInt(v[3],10));const T=D.auth.user.user_id,E=D.auth.user.email,b=c({show:!1,message:"",type:""}),t=M({lastname:"",email:"",radRx_type:"",radRx_initial_date:"",radRx_last_date:"",radRx_dose:"",radRx_bodySite:"",radRx_status:"",radRx_isCompleted:Boolean,radRx_facility:"",radRx_doctor:""}),U=c(0),h=c([]),I=c([]),L=c([]);if(c(0),k){const r=new URL(k,window.location.origin);U.value=r.searchParams.get("currentStep"),console.log(U.value)}else console.error("URL is undefined");const N=async()=>{try{const a=(await p.get("/api/all-patients")).data.find(R=>R.patient_id===m);if(console.log("Found patient:",a),a){const R=a.user;t.lastname=R.lastname,t.email=R.email}}catch(r){console.error("Failed to fetch patient info:",r)}},B=async r=>{try{const a=(await p.get(`/api/patient/${r}/treatments`)).data;console.log(a),t.radRx_type=a.radiotherapies[n].radRx_type,t.radRx_initial_date=a.radiotherapies[n].radRx_initial_date,t.radRx_last_date=a.radiotherapies[n].radRx_last_date,t.radRx_dose=a.radiotherapies[n].radRx_dose,t.radRx_bodySite=a.radiotherapies[n].radRx_bodySite,t.radRx_status=a.radiotherapies[n].radRx_status,t.radRx_isCompleted=a.radiotherapies[n].radRx_isCompleted===1,t.radRx_facility=a.radiotherapies[n].radRx_facility,t.radRx_doctor=a.radiotherapies[n].radRx_doctor}catch(e){console.error("Failed to fetch patient:",e)}};O(async()=>{await N(),await B(m);try{const[r,e,a]=await Promise.all([p.get("/api/all-doctors"),p.get("/api/hospitals"),p.get("/api/rad-details")]);I.value=r.data,L.value=e.data,h.value=a.data}catch(r){console.error("Error loading initial data:",r)}});const F=async()=>{try{b.value.show=!1,console.log(t);const r=await p.put(`/api/treatment/update/radiotherapy/${m}`,t),e=await p.get(`/api/get-patient/${m}`);await p.post("/api/create-notification-log",{from:E,to:e.data.user.email,subject:"Treatment Information Updated",message:"The patient's RADIOTHERAPY treatment is updated",senderId:T,receiverId:e.data.user.user_id,notificationStatus:1,notificationType:5}),r.status===200?(b.value={show:!0,message:"Success! Radiotherapy details updated.",type:"success"},z.Inertia.get("/search")):console.error("Error updating details:",r.status)}catch(r){console.error("Error updating details:",r)}};return(r,e)=>(u(),P(Q,null,{default:_(()=>[e[25]||(e[25]=s("div",{class:"page-heading"},[s("h1",{class:"main-heading"},"RADIOTHERAPHY")],-1)),s("form",{onSubmit:j(F,["prevent"]),class:"form-container"},[s("div",null,[o(i,{for:"lastname"},{default:_(()=>e[12]||(e[12]=[x(" Last Name "),s("span",{class:"red-asterisk"},"*",-1)])),_:1}),o(g,{id:"lastname",modelValue:l(t).lastname,"onUpdate:modelValue":e[0]||(e[0]=a=>l(t).lastname=a),type:"text",class:"mt-1 block w-full",autofocus:"",autocomplete:"lastname",disabled:""},null,8,["modelValue"]),o(d,{class:"mt-2",message:l(t).errors.lastname},null,8,["message"])]),s("div",null,[o(i,{for:"email"},{default:_(()=>e[13]||(e[13]=[x(" Email Address "),s("span",{class:"red-asterisk"},"*",-1)])),_:1}),o(g,{id:"email",modelValue:l(t).email,"onUpdate:modelValue":e[1]||(e[1]=a=>l(t).email=a),type:"email",class:"mt-1 block w-full",autocomplete:"username",disabled:""},null,8,["modelValue"]),o(d,{class:"mt-2",message:l(t).errors.email},null,8,["message"])]),s("div",null,[o(i,{for:"radRx_type"},{default:_(()=>e[14]||(e[14]=[x(" Radiotherapy Type ")])),_:1}),y(s("select",{id:"radRx_type","onUpdate:modelValue":e[2]||(e[2]=a=>l(t).radRx_type=a),class:"mt-1 block w-full",required:""},[e[15]||(e[15]=s("option",{value:"",disabled:""},"Select Radiotherapy Type",-1)),(u(!0),f(C,null,S(h.value,a=>(u(),f("option",{key:a.radDetails_id,value:a.radDetails_id},w(a.radDetails_name),9,J))),128))],512),[[V,l(t).radRx_type]]),o(d,{class:"mt-2",message:l(t).errors.radRx_type},null,8,["message"])]),s("div",null,[o(i,{for:"radRx_initialDate",value:"Initial Radiotherapy Date"}),o(g,{id:"radRx_initialDate",modelValue:l(t).radRx_initial_date,"onUpdate:modelValue":e[3]||(e[3]=a=>l(t).radRx_initial_date=a),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),o(d,{class:"mt-2",message:l(t).errors.radRx_initialDate},null,8,["message"])]),s("div",null,[o(i,{for:"radRx_lastDate",value:"Last Radiotherapy Date"}),o(g,{id:"radRx_lastDate",modelValue:l(t).radRx_last_date,"onUpdate:modelValue":e[4]||(e[4]=a=>l(t).radRx_last_date=a),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),o(d,{class:"mt-2",message:l(t).errors.radRx_lastDate},null,8,["message"])]),s("div",null,[o(i,{for:"radRx_dose",value:"Radiotherapy Dose"}),o(g,{id:"radRx_dose",modelValue:l(t).radRx_dose,"onUpdate:modelValue":e[5]||(e[5]=a=>l(t).radRx_dose=a),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),o(d,{class:"mt-2",message:l(t).errors.radRx_dose},null,8,["message"])]),s("div",null,[o(i,{for:"radRx_bodySite",value:"Radiotherapy Body Site"}),o(g,{id:"radRx_bodySite",modelValue:l(t).radRx_bodySite,"onUpdate:modelValue":e[6]||(e[6]=a=>l(t).radRx_bodySite=a),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),o(d,{class:"mt-2",message:l(t).errors.radRx_bodySite},null,8,["message"])]),s("div",null,[o(i,{for:"radRx_status",value:"Radiotherapy Status"}),y(s("select",{id:"radRx_status","onUpdate:modelValue":e[7]||(e[7]=a=>l(t).radRx_status=a),class:"mt-1 block w-full"},e[16]||(e[16]=[s("option",{value:"",disabled:""},"Select Radiotherapy Status",-1),s("option",{value:"Ongoing"},"Ongoing",-1),s("option",{value:"Completed"},"Completed",-1),s("option",{value:"Not Completed"},"Not Completed",-1)]),512),[[V,l(t).radRx_status]]),o(d,{class:"mt-2",message:l(t).errors.radRx_status},null,8,["message"])]),s("div",null,[o(i,{for:"radRx_isCompleted",value:"Radiotheraphy Completed"}),s("div",K,[s("label",W,[y(s("input",{type:"radio",name:"radRx_isCompleted",value:!0,"onUpdate:modelValue":e[8]||(e[8]=a=>l(t).radRx_isCompleted=a),class:"form-radio"},null,512),[[$,l(t).radRx_isCompleted]]),e[17]||(e[17]=s("span",{class:"custom-radio"},null,-1)),e[18]||(e[18]=s("span",{class:"ml-2"},"Yes",-1))]),s("label",X,[y(s("input",{type:"radio",name:"radRx_isCompleted",value:!1,"onUpdate:modelValue":e[9]||(e[9]=a=>l(t).radRx_isCompleted=a),class:"form-radio"},null,512),[[$,l(t).radRx_isCompleted]]),e[19]||(e[19]=s("span",{class:"custom-radio"},null,-1)),e[20]||(e[20]=s("span",{class:"ml-2"},"No",-1))])]),o(d,{class:"mt-2",message:l(t).errors.radRx_isCompleted},null,8,["message"])]),s("div",null,[o(i,{for:"radRx_facility"},{default:_(()=>e[21]||(e[21]=[x(" Radiotherapy Facility ")])),_:1}),y(s("select",{id:"radRx_facility","onUpdate:modelValue":e[10]||(e[10]=a=>l(t).radRx_facility=a),class:"mt-1 block w-full",required:""},[e[22]||(e[22]=s("option",{value:"",disabled:""},"Select facility",-1)),(u(!0),f(C,null,S(L.value,a=>(u(),f("option",{key:a.hospital_id,value:a.hospital_id},w(a.hospital_name),9,Z))),128))],512),[[V,l(t).radRx_facility]]),o(d,{class:"mt-2",message:l(t).errors.radRx_facility},null,8,["message"])]),s("div",null,[o(i,{for:"radRx_doctor"},{default:_(()=>e[23]||(e[23]=[x(" Radiotherapy Doctor ")])),_:1}),y(s("select",{id:"radRx_doctor","onUpdate:modelValue":e[11]||(e[11]=a=>l(t).radRx_doctor=a),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:"",disabled:r.isLoading},[s("option",ae,w(r.isLoading?"Loading doctors...":"Select a Doctor"),1),(u(!0),f(C,null,S(I.value,a=>(u(),f("option",{key:a.doctor_id,value:a.doctor_id},w("Dr. "+`${a.user.firstname} ${a.user.middlename} ${a.user.lastname}`.toLowerCase().split(" ").map(R=>R.charAt(0).toUpperCase()+R.slice(1)).join(" ")),9,te))),128))],8,ee),[[V,l(t).radRx_doctor]]),o(d,{class:"mt-2",message:l(t).errors.radRx_doctor},null,8,["message"]),r.error?(u(),f("p",se,w(r.error),1)):A("",!0)]),s("div",le,[o(H,{onClick:r.nextStep,class:"ms-4"},{default:_(()=>e[24]||(e[24]=[x(" Update Details ")])),_:1},8,["onClick"])])],32),b.value.show?(u(),P(Y,{key:0,message:b.value.message,type:b.value.type},null,8,["message","type"])):A("",!0)]),_:1}))}},ye=G(oe,[["__scopeId","data-v-bde9ce67"]]);export{ye as default};
