import{Q as q,T as M,d as v,l as O,m as b,o as u,c as C,w as p,a as s,b as o,g as R,u as l,q as _,v as k,e as x,h as S,t as D,F as U,A as N,f as I,k as j}from"./app-42536e63.js";import{_ as d}from"./InputError-d893a523.js";import{_ as i}from"./InputLabel-ff26f500.js";import{_ as y}from"./TextInput-d9580142.js";import{_ as $}from"./PrimaryButton-cd95b478.js";import H from"./Layout-1c104a2a.js";import{d as L}from"./index-189aeacd.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";import"./DropdownLink-ed97a0d6.js";/* empty css                                                               */const Q=["value"],z={class:"mt-1 flex flex-col gap-2"},G={class:"inline-flex items-center"},J={class:"inline-flex items-center"},K=["value"],W=["disabled"],X={value:"",disabled:"",selected:""},Z=["value"],ee={key:0,class:"mt-2 text-sm text-red-600"},ae={class:"flex items-center justify-center mt-4"},te={__name:"RadiotherapyPage",setup(se){const{url:V}=q(),c=V.split("/");let m=c[c.length-1];m=parseInt(m,10),console.log("Patient ID:",m);let n;c.length===5&&(n=parseInt(c[3],10),m=parseInt(c[4],10));const t=M({lastname:"",email:"",radRx_type:"",radRx_initialDate:"",radRx_lastDate:"",radRx_dose:"",radRx_bodySite:"",radRx_status:"",radRx_isCompleted:Boolean,radRx_facility:"",radRx_doctor:""}),g=v(0),P=v([]),h=v([]),B=v([]),w=v(0);if(V){const r=new URL(V,window.location.origin);g.value=r.searchParams.get("currentStep"),console.log(g.value)}else console.error("URL is undefined");const F=()=>{L.Inertia.visit(document.referrer)},A=async()=>{try{const a=(await b.get("/api/all-patients")).data.find(f=>f.patient_id===m);if(console.log("Found patient:",a),a){const f=a.user;t.lastname=f.lastname,t.email=f.email}}catch(r){console.error("Failed to fetch patient info:",r)}},E=async r=>{try{const a=(await b.get(`/api/patient/${r}/treatments`)).data;console.log(a),t.radRx_type=a.radiotherapies[n].radRx_type,t.radRx_initialDate=a.radiotherapies[n].radRx_initialDate,t.radRx_lastDate=a.radiotherapies[n].radRx_lastDate,t.radRx_dose=a.radiotherapies[n].radRx_dose,t.radRx_bodySite=a.radiotherapies[n].radRx_bodySite,t.radRx_status=a.radiotherapies[n].radRx_status,t.radRx_isCompleted=a.radiotherapies[n].radRx_isCompleted===1,t.radRx_facility=a.radiotherapies[n].radRx_facility,t.radRx_doctor=a.radiotherapies[n].radRx_doctor}catch(e){console.error("Failed to fetch patient:",e)}};O(async()=>{await A(),await E(m);try{const[r,e,a]=await Promise.all([b.get("/api/all-doctors"),b.get("/api/hospitals"),b.get("/api/rad-details")]);h.value=r.data,B.value=e.data,P.value=a.data}catch(r){console.error("Error loading initial data:",r)}});const T=()=>{console.log(t),t.post("/api/create-radiotherapy-record",{onSuccess:()=>{console.log(w),w.value===1?L.Inertia.visit(`/treatment-history/radiotherapy/${m}`):g.value?L.Inertia.visit(`/consult/${m}`):window.location.href=`/treatment-history/chemotherapy/${m}`},onError:r=>{r.patient_id?error.value=r.patient_id[0]:console.log(r)}})};return(r,e)=>(u(),C(H,null,{default:p(()=>[e[28]||(e[28]=s("div",{class:"page-heading"},[s("h1",{class:"main-heading"},"RADIOTHERAPHY")],-1)),s("form",{onSubmit:j(T,["prevent"]),class:"form-container"},[s("div",null,[o(i,{for:"lastname"},{default:p(()=>e[13]||(e[13]=[R(" Last Name "),s("span",{class:"red-asterisk"},"*",-1)])),_:1}),o(y,{id:"lastname",modelValue:l(t).lastname,"onUpdate:modelValue":e[0]||(e[0]=a=>l(t).lastname=a),type:"text",class:"mt-1 block w-full",autofocus:"",autocomplete:"lastname"},null,8,["modelValue"]),o(d,{class:"mt-2",message:l(t).errors.lastname},null,8,["message"])]),s("div",null,[o(i,{for:"email"},{default:p(()=>e[14]||(e[14]=[R(" Email Address "),s("span",{class:"red-asterisk"},"*",-1)])),_:1}),o(y,{id:"email",modelValue:l(t).email,"onUpdate:modelValue":e[1]||(e[1]=a=>l(t).email=a),type:"email",class:"mt-1 block w-full",autocomplete:"username"},null,8,["modelValue"]),o(d,{class:"mt-2",message:l(t).errors.email},null,8,["message"])]),s("div",null,[o(i,{for:"radRx_type"},{default:p(()=>e[15]||(e[15]=[R(" Radiotherapy Type ")])),_:1}),_(s("select",{id:"radRx_type","onUpdate:modelValue":e[2]||(e[2]=a=>l(t).radRx_type=a),class:"mt-1 block w-full",required:""},[e[16]||(e[16]=s("option",{value:"",disabled:""},"Select Radiotherapy Type",-1)),(u(!0),x(U,null,S(P.value,a=>(u(),x("option",{key:a.radDetails_id,value:a.radDetails_id},D(a.radDetails_name),9,Q))),128))],512),[[k,l(t).radRx_type]]),o(d,{class:"mt-2",message:l(t).errors.radRx_type},null,8,["message"])]),s("div",null,[o(i,{for:"radRx_initialDate",value:"Initial Radiotherapy Date"}),o(y,{id:"radRx_initialDate",modelValue:l(t).radRx_initialDate,"onUpdate:modelValue":e[3]||(e[3]=a=>l(t).radRx_initialDate=a),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),o(d,{class:"mt-2",message:l(t).errors.radRx_initialDate},null,8,["message"])]),s("div",null,[o(i,{for:"radRx_lastDate",value:"Last Radiotherapy Date"}),o(y,{id:"radRx_lastDate",modelValue:l(t).radRx_lastDate,"onUpdate:modelValue":e[4]||(e[4]=a=>l(t).radRx_lastDate=a),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),o(d,{class:"mt-2",message:l(t).errors.radRx_lastDate},null,8,["message"])]),s("div",null,[o(i,{for:"radRx_dose",value:"Radiotherapy Dose"}),o(y,{id:"radRx_dose",modelValue:l(t).radRx_dose,"onUpdate:modelValue":e[5]||(e[5]=a=>l(t).radRx_dose=a),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),o(d,{class:"mt-2",message:l(t).errors.radRx_dose},null,8,["message"])]),s("div",null,[o(i,{for:"radRx_bodySite",value:"Radiotherapy Body Site"}),o(y,{id:"radRx_bodySite",modelValue:l(t).radRx_bodySite,"onUpdate:modelValue":e[6]||(e[6]=a=>l(t).radRx_bodySite=a),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),o(d,{class:"mt-2",message:l(t).errors.radRx_bodySite},null,8,["message"])]),s("div",null,[o(i,{for:"radRx_status",value:"Radiotherapy Status"}),_(s("select",{id:"radRx_status","onUpdate:modelValue":e[7]||(e[7]=a=>l(t).radRx_status=a),class:"mt-1 block w-full"},e[17]||(e[17]=[s("option",{value:"",disabled:""},"Select Radiotherapy Status",-1),s("option",{value:"Ongoing"},"Ongoing",-1),s("option",{value:"Completed"},"Completed",-1),s("option",{value:"Not Completed"},"Not Completed",-1)]),512),[[k,l(t).radRx_status]]),o(d,{class:"mt-2",message:l(t).errors.radRx_status},null,8,["message"])]),s("div",null,[o(i,{for:"radRx_isCompleted",value:"Radiotheraphy Completed"}),s("div",z,[s("label",G,[_(s("input",{type:"radio",name:"radRx_isCompleted",value:!0,"onUpdate:modelValue":e[8]||(e[8]=a=>l(t).radRx_isCompleted=a),class:"form-radio"},null,512),[[N,l(t).radRx_isCompleted]]),e[18]||(e[18]=s("span",{class:"custom-radio"},null,-1)),e[19]||(e[19]=s("span",{class:"ml-2"},"Yes",-1))]),s("label",J,[_(s("input",{type:"radio",name:"radRx_isCompleted",value:!1,"onUpdate:modelValue":e[9]||(e[9]=a=>l(t).radRx_isCompleted=a),class:"form-radio"},null,512),[[N,l(t).radRx_isCompleted]]),e[20]||(e[20]=s("span",{class:"custom-radio"},null,-1)),e[21]||(e[21]=s("span",{class:"ml-2"},"No",-1))])]),o(d,{class:"mt-2",message:l(t).errors.radRx_isCompleted},null,8,["message"])]),s("div",null,[o(i,{for:"radRx_facility"},{default:p(()=>e[22]||(e[22]=[R(" Radiotherapy Facility ")])),_:1}),_(s("select",{id:"radRx_facility","onUpdate:modelValue":e[10]||(e[10]=a=>l(t).radRx_facility=a),class:"mt-1 block w-full",required:""},[e[23]||(e[23]=s("option",{value:"",disabled:""},"Select facility",-1)),(u(!0),x(U,null,S(B.value,a=>(u(),x("option",{key:a.hospital_id,value:a.hospital_id},D(a.hospital_name),9,K))),128))],512),[[k,l(t).radRx_facility]]),o(d,{class:"mt-2",message:l(t).errors.radRx_facility},null,8,["message"])]),s("div",null,[o(i,{for:"radRx_doctor"},{default:p(()=>e[24]||(e[24]=[R(" Radiotherapy Doctor ")])),_:1}),_(s("select",{id:"radRx_doctor","onUpdate:modelValue":e[11]||(e[11]=a=>l(t).radRx_doctor=a),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:"",disabled:r.isLoading},[s("option",X,D(r.isLoading?"Loading doctors...":"Select a Doctor"),1),(u(!0),x(U,null,S(h.value,a=>(u(),x("option",{key:a.doctor_id,value:a.doctor_id},D("Dr. "+`${a.user.firstname} ${a.user.middlename} ${a.user.lastname}`.toLowerCase().split(" ").map(f=>f.charAt(0).toUpperCase()+f.slice(1)).join(" ")),9,Z))),128))],8,W),[[k,l(t).radRx_doctor]]),o(d,{class:"mt-2",message:l(t).errors.radRx_doctor},null,8,["message"]),r.error?(u(),x("p",ee,D(r.error),1)):I("",!0)]),s("div",ae,[g.value?(u(),C($,{key:0,onClick:F,class:"ms-4"},{default:p(()=>e[25]||(e[25]=[R(" Back ")])),_:1})):I("",!0),g.value?I("",!0):(u(),C($,{key:1,onClick:e[12]||(e[12]=a=>w.value=1),class:"ms-4"},{default:p(()=>e[26]||(e[26]=[R(" Submit ")])),_:1})),o($,{onClick:r.nextStep,class:"ms-4"},{default:p(()=>e[27]||(e[27]=[R(" Submit and Proceed ")])),_:1},8,["onClick"])])],32)]),_:1}))}},fe=Y(te,[["__scopeId","data-v-0a66ee10"]]);export{fe as default};
