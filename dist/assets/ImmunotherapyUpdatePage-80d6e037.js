import{Q as B,d as R,T as O,l as j,m as p,o as _,c as h,w as f,a as o,b as l,g as y,u as a,q as v,v as V,A as S,e as I,h as D,t as b,F as N,f as $,k as q}from"./app-42536e63.js";import{_ as i}from"./InputError-d893a523.js";import{_ as n}from"./InputLabel-ff26f500.js";import{_ as c}from"./TextInput-d9580142.js";import{_ as H}from"./PrimaryButton-cd95b478.js";import Y from"./Layout-1c104a2a.js";import{A as Q}from"./Alert-e9943a8b.js";import{d as z}from"./index-189aeacd.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";import"./DropdownLink-ed97a0d6.js";/* empty css                                                               */const J={class:"mt-1 flex flex-col gap-2"},K={class:"inline-flex items-center"},W={class:"inline-flex items-center"},X=["value"],Z=["disabled"],ee={value:"",disabled:"",selected:""},te=["value"],se={key:0,class:"mt-2 text-sm text-red-600"},oe={class:"flex items-center justify-center mt-4"},ae={__name:"ImmunotherapyUpdatePage",setup(le){const{url:w,props:U}=B(),x=w.split("/");let r=x[x.length-1];r=parseInt(r,10),console.log("Patient ID:",r);let u;x.length===4&&(u=parseInt(x[2],10),r=parseInt(x[3],10));const L=U.auth.user.user_id,P=U.auth.user.email,g=R({show:!1,message:"",type:""}),s=O({lastname:"",email:"",immunoRx_drugs:"",immunoRx_initial_date:"",immunoRx_end_date:"",immunoRx_status:"",immunoRx_notes:"",immunoRx_isCompleted:Boolean,immunoRx_facility:"",immunoRx_doctor:""}),E=R(0),C=R([]),k=R([]),M=R(0);if(w){const m=new URL(w,window.location.origin);E.value=m.searchParams.get("currentStep")}else console.error("URL is undefined");const T=async()=>{try{const t=(await p.get("/api/all-patients")).data.find(d=>d.patient_id===r);if(console.log("Found patient:",t),t){const d=t.user;s.lastname=d.lastname,s.email=d.email}}catch(m){console.error("Failed to fetch patient info:",m)}},A=async m=>{try{const t=(await p.get(`/api/patient/${m}/treatments`)).data;console.log(t),s.immunoRx_drugs=t.immunotherapies[u].immunoRx_drugs,s.immunoRx_initial_date=t.immunotherapies[u].immunoRx_initial_date,s.immunoRx_end_date=t.immunotherapies[u].immunoRx_end_date,s.immunoRx_status=t.immunotherapies[u].immunoRx_status,s.immunoRx_notes=t.immunotherapies[u].immunoRx_notes,s.immunoRx_isCompleted=t.immunotherapies[u].immunoRx_isCompleted===1,s.immunoRx_facility=t.immunotherapies[u].immunoRx_facility,s.immunoRx_doctor=t.immunotherapies[u].immunoRx_doctor}catch(e){console.error("Failed to fetch patient:",e)}};j(async()=>{await T(),await A(r);try{const[m,e]=await Promise.all([p.get("/api/all-doctors"),p.get("/api/hospitals")]);C.value=m.data,k.value=e.data}catch(m){console.error("Error loading initial data:",m)}});const F=async()=>{try{g.value.show=!1,console.log(s);const m=await p.put(`/api/treatment/update/immunotherapy/${r}`,s),e=await p.get(`/api/get-patient/${r}`);await p.post("/api/create-notification-log",{from:P,to:e.data.user.email,subject:"Treatment Information Updated",message:"The patient's IMMUNOTHERAPY treatment is updated",senderId:L,receiverId:e.data.user.user_id,notificationStatus:1,notificationType:5}),m.status===200?(g.value={show:!0,message:"Success! Immunotherapy details updated.",type:"success"},z.Inertia.get("/search")):console.error("Error updating details:",m.status)}catch(m){console.error("Error updating details:",m)}};return(m,e)=>(_(),h(Y,null,{default:f(()=>[e[23]||(e[23]=o("div",{class:"page-heading"},[o("h1",{class:"main-heading"},"IMMUNOTHERAPHY")],-1)),o("form",{onSubmit:q(F,["prevent"]),class:"form-container"},[o("div",null,[l(n,{for:"lastname"},{default:f(()=>e[12]||(e[12]=[y(" Last Name "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),l(c,{id:"lastname",modelValue:a(s).lastname,"onUpdate:modelValue":e[0]||(e[0]=t=>a(s).lastname=t),type:"text",class:"mt-1 block w-full",autofocus:"",autocomplete:"lastname",disabled:""},null,8,["modelValue"]),l(i,{class:"mt-2",message:a(s).errors.lastname},null,8,["message"])]),o("div",null,[l(n,{for:"email"},{default:f(()=>e[13]||(e[13]=[y(" Email Address "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),l(c,{id:"email",modelValue:a(s).email,"onUpdate:modelValue":e[1]||(e[1]=t=>a(s).email=t),type:"email",class:"mt-1 block w-full",autocomplete:"username",disabled:""},null,8,["modelValue"]),l(i,{class:"mt-2",message:a(s).errors.email},null,8,["message"])]),o("div",null,[l(n,{for:"immunoRx_drugs",value:"Immunotherapy Drug"}),l(c,{id:"immunoRx_drugs",modelValue:a(s).immunoRx_drugs,"onUpdate:modelValue":e[2]||(e[2]=t=>a(s).immunoRx_drugs=t),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),l(i,{message:a(s).errors.immunoRx_drugs},null,8,["message"])]),o("div",null,[l(n,{for:"immunoRx_initialDate",value:"Initial Immunotherapy Date"}),l(c,{id:"immunoRx_initial_date",modelValue:a(s).immunoRx_initial_date,"onUpdate:modelValue":e[3]||(e[3]=t=>a(s).immunoRx_initial_date=t),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),l(i,{class:"mt-2",message:a(s).errors.immunoRx_initial_date},null,8,["message"])]),o("div",null,[l(n,{for:"immunoRx_end_date",value:"Last Immunotherapy Date"}),l(c,{id:"immunoRx_end_date",modelValue:a(s).immunoRx_end_date,"onUpdate:modelValue":e[4]||(e[4]=t=>a(s).immunoRx_end_date=t),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),l(i,{class:"mt-2",message:a(s).errors.immunoRx_end_date},null,8,["message"])]),o("div",null,[l(n,{for:"immunoRx_status",value:"Immunotherapy Status"}),v(o("select",{id:"immunoRx_status","onUpdate:modelValue":e[5]||(e[5]=t=>a(s).immunoRx_status=t),class:"mt-1 block w-full"},e[14]||(e[14]=[o("option",{value:"",disabled:""},"Select Immunotherapy Status",-1),o("option",{value:"Ongoing"},"Ongoing",-1),o("option",{value:"Completed"},"Completed",-1),o("option",{value:"Not Completed"},"Not Completed",-1)]),512),[[V,a(s).immunoRx_status]]),l(i,{class:"mt-2",message:a(s).errors.immunoRx_status},null,8,["message"])]),o("div",null,[l(n,{for:"immunoRx_notes",value:"Immunotherapy Notes"}),l(c,{id:"immunoRx_notes",modelValue:a(s).immunoRx_notes,"onUpdate:modelValue":e[6]||(e[6]=t=>a(s).immunoRx_notes=t),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),l(i,{class:"mt-2",message:a(s).errors.immunoRx_notes},null,8,["message"])]),o("div",null,[l(n,{for:"immunoRx_isCompleted",value:"Immunotheraphy Completed"}),o("div",J,[o("label",K,[v(o("input",{type:"radio",name:"immunoRx_isCompleted",value:!0,"onUpdate:modelValue":e[7]||(e[7]=t=>a(s).immunoRx_isCompleted=t),class:"form-radio"},null,512),[[S,a(s).immunoRx_isCompleted]]),e[15]||(e[15]=o("span",{class:"custom-radio"},null,-1)),e[16]||(e[16]=o("span",{class:"ml-2"},"Yes",-1))]),o("label",W,[v(o("input",{type:"radio",name:"immunoRx_isCompleted",value:!1,"onUpdate:modelValue":e[8]||(e[8]=t=>a(s).immunoRx_isCompleted=t),class:"form-radio"},null,512),[[S,a(s).immunoRx_isCompleted]]),e[17]||(e[17]=o("span",{class:"custom-radio"},null,-1)),e[18]||(e[18]=o("span",{class:"ml-2"},"No",-1))])]),l(i,{class:"mt-2",message:a(s).errors.immunoRx_isCompleted},null,8,["message"])]),o("div",null,[l(n,{for:"immunoRx_facility"},{default:f(()=>e[19]||(e[19]=[y(" Immunotherapy Facility ")])),_:1}),v(o("select",{id:"immunoRx_facility","onUpdate:modelValue":e[9]||(e[9]=t=>a(s).immunoRx_facility=t),class:"mt-1 block w-full",required:""},[e[20]||(e[20]=o("option",{value:"",disabled:""},"Select facility",-1)),(_(!0),I(N,null,D(k.value,t=>(_(),I("option",{key:t.hospital_id,value:t.hospital_id},b(t.hospital_name),9,X))),128))],512),[[V,a(s).immunoRx_facility]]),l(i,{class:"mt-2",message:a(s).errors.immunoRx_facility},null,8,["message"])]),o("div",null,[l(n,{for:"immunoRx_doctor"},{default:f(()=>e[21]||(e[21]=[y(" Immunotherapy Doctor ")])),_:1}),v(o("select",{id:"immunoRx_doctor","onUpdate:modelValue":e[10]||(e[10]=t=>a(s).immunoRx_doctor=t),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:"",disabled:m.isLoading},[o("option",ee,b(m.isLoading?"Loading doctors...":"Select a Doctor"),1),(_(!0),I(N,null,D(C.value,t=>(_(),I("option",{key:t.doctor_id,value:t.doctor_id},b("Dr. "+`${t.user.firstname} ${t.user.middlename} ${t.user.lastname}`.toLowerCase().split(" ").map(d=>d.charAt(0).toUpperCase()+d.slice(1)).join(" ")),9,te))),128))],8,Z),[[V,a(s).immunoRx_doctor]]),l(i,{class:"mt-2",message:a(s).errors.immunoRx_doctor},null,8,["message"]),m.error?(_(),I("p",se,b(m.error),1)):$("",!0)]),o("div",oe,[l(H,{onClick:e[11]||(e[11]=t=>M.value=1),class:"ms-4"},{default:f(()=>e[22]||(e[22]=[y(" Update Details ")])),_:1})])],32),g.value.show?(_(),h(Q,{key:0,message:g.value.message,type:g.value.type},null,8,["message","type"])):$("",!0)]),_:1}))}},ge=G(ae,[["__scopeId","data-v-2bc707ab"]]);export{ge as default};
