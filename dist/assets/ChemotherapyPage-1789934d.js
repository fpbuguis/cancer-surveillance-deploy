import{Q as T,T as M,d as g,l as q,m as C,o as d,c as D,w as c,a as l,b as a,g as p,u as s,q as f,v as b,e as _,h as N,t as k,F as U,A as R,f as S,k as H}from"./app-42536e63.js";import{_ as i}from"./InputError-d893a523.js";import{_ as n}from"./InputLabel-ff26f500.js";import{_ as y}from"./TextInput-d9580142.js";import O from"./Layout-1c104a2a.js";import{_ as x}from"./PrimaryButton-cd95b478.js";import{d as I}from"./index-189aeacd.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";import"./DropdownLink-ed97a0d6.js";/* empty css                                                               */const Y=["value"],Q={class:"mt-1 flex flex-col gap-2"},z={class:"inline-flex items-center"},J={class:"inline-flex items-center"},K=["value"],W=["disabled"],X={value:"",disabled:"",selected:""},Z=["value"],ee={key:0,class:"mt-2 text-sm text-red-600"},oe={class:"flex items-center justify-center mt-4"},te={__name:"ChemotherapyPage",setup(le){const{url:w}=T(),v=w.split("/");let u=v[v.length-1];u=parseInt(u,10),console.log("Patient ID:",u);let r;v.length===5&&(r=parseInt(v[3],10),u=parseInt(v[4],10));const t=M({lastname:"",email:"",chemo_type:"",chemotherapy_given:"",chemo_initialDate:"",chemo_endDate:"",chemo_cycleNumber:"",chemo_status:"",chemo_notes:"",chemo_isCompleted:Boolean,chemo_facility:"",chemo_doctor:""}),V=g(0),P=g([]),$=g([]),L=g([]),B=g(0);if(w){const m=new URL(w,window.location.origin);V.value=m.searchParams.get("currentStep")}else console.error("URL is undefined");const j=()=>{I.Inertia.visit(document.referrer)},A=async()=>{try{const o=(await C.get("/api/all-patients")).data.find(h=>h.patient_id===u);if(console.log("Found patient:",o),o){const h=o.user;t.lastname=h.lastname,t.email=h.email}}catch(m){console.error("Failed to fetch patient info:",m)}},E=async m=>{try{const o=(await C.get(`/api/patient/${m}/treatments`)).data;console.log(o),t.chemo_type=o.chemotherapies[r].chemo_type,t.chemotherapy_given=o.chemotherapies[r].chemo_protocol,t.chemo_initialDate=o.chemotherapies[r].chemo_initial_date,t.chemo_endDate=o.chemotherapies[r].chemo_end_date,t.chemo_cycleNumber=o.chemotherapies[r].chemo_cycleNumGiven,t.chemo_status=o.chemotherapies[r].chemo_status,t.chemo_notes=o.chemotherapies[r].chemo_notes,t.chemo_isCompleted=o.chemotherapies[r].chemo_isCompleted===1,t.chemo_facility=o.chemotherapies[r].chemo_facility,t.chemo_doctor=o.chemotherapies[r].chemo_doctor}catch(e){console.error("Failed to fetch patient:",e)}};q(async()=>{await A(),await E(u);try{const[m,e,o]=await Promise.all([C.get("/api/all-doctors"),C.get("/api/hospitals"),C.get("/api/chemoprotocols")]);console.log("Doctors:",m.data),console.log("Hospitals:",e.data),console.log("Chemoprotocols:",o.data),P.value=m.data,$.value=e.data,L.value=o.data}catch(m){console.error("Error loading initial data:",m)}});const F=()=>{console.log(t),t.post("/api/create-chemotherapy-record",{onSuccess:()=>{B.value===1?I.Inertia.visit(`/treatment-history/chemotherapy/${u}`):V.value?I.Inertia.visit(`/consult/${u}`):window.location.href=`/treatment-history/immunotherapy/${u}`},onError:m=>{m.patient_id?error.value=m.patient_id[0]:console.log(m)}})};return(m,e)=>(d(),D(O,null,{default:c(()=>[e[30]||(e[30]=l("div",{class:"page-heading"},[l("h1",{class:"main-heading"},"CHEMOTHERAPHY")],-1)),l("form",{onSubmit:H(F,["prevent"]),class:"form-container"},[l("div",null,[a(n,{for:"lastname"},{default:c(()=>e[14]||(e[14]=[p(" Last Name "),l("span",{class:"red-asterisk"},"*",-1)])),_:1}),a(y,{id:"lastname",modelValue:s(t).lastname,"onUpdate:modelValue":e[0]||(e[0]=o=>s(t).lastname=o),type:"text",class:"mt-1 block w-full",autofocus:"",autocomplete:"lastname"},null,8,["modelValue"]),a(i,{class:"mt-2",message:s(t).errors.lastname},null,8,["message"])]),l("div",null,[a(n,{for:"email"},{default:c(()=>e[15]||(e[15]=[p(" Email Address "),l("span",{class:"red-asterisk"},"*",-1)])),_:1}),a(y,{id:"email",modelValue:s(t).email,"onUpdate:modelValue":e[1]||(e[1]=o=>s(t).email=o),type:"email",class:"mt-1 block w-full",autocomplete:"username"},null,8,["modelValue"]),a(i,{class:"mt-2",message:s(t).errors.email},null,8,["message"])]),l("div",null,[a(n,{for:"chemo_type",value:"Chemotherapy Type"}),f(l("select",{id:"chemo_type","onUpdate:modelValue":e[2]||(e[2]=o=>s(t).chemo_type=o),class:"mt-1 block w-full"},e[16]||(e[16]=[l("option",{value:"",disabled:""},"Select Chemotherapy Type",-1),l("option",{value:"Neoadjuvant"},"Neoadjuvant",-1),l("option",{value:"Adjuvant"},"Adjuvant",-1),l("option",{value:"Palliative"},"Palliative",-1)]),512),[[b,s(t).chemo_type]]),a(i,{message:s(t).errors.chemo_type},null,8,["message"])]),l("div",null,[a(n,{for:"chemotherapy_given"},{default:c(()=>e[17]||(e[17]=[p(" Chemotherapy Given ")])),_:1}),f(l("select",{id:"chemotherapy_given","onUpdate:modelValue":e[3]||(e[3]=o=>s(t).chemotherapy_given=o),class:"mt-1 block w-full",required:""},[e[18]||(e[18]=l("option",{value:"",disabled:""},"Select Chemotheraphy",-1)),(d(!0),_(U,null,N(L.value,o=>(d(),_("option",{key:o.chemo_protocol_id,value:o.chemo_protocol_id},k(o.chemo_drugs),9,Y))),128))],512),[[b,s(t).chemotherapy_given]]),a(i,{class:"mt-2",message:s(t).errors.chemotherapy_given},null,8,["message"])]),l("div",null,[a(n,{for:"chemo_initialDate",value:"Initial Chemotherapy Date"}),a(y,{id:"chemo_initialDate",modelValue:s(t).chemo_initialDate,"onUpdate:modelValue":e[4]||(e[4]=o=>s(t).chemo_initialDate=o),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),a(i,{class:"mt-2",message:s(t).errors.chemo_initialDate},null,8,["message"])]),l("div",null,[a(n,{for:"chemo_endDate",value:"Last Chemotherapy Date"}),a(y,{id:"chemo_endDate",modelValue:s(t).chemo_endDate,"onUpdate:modelValue":e[5]||(e[5]=o=>s(t).chemo_endDate=o),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),a(i,{class:"mt-2",message:s(t).errors.chemo_endDate},null,8,["message"])]),l("div",null,[a(n,{for:"chemo_cycleNumber",value:"Chemotherapy No. of Cycles"}),a(y,{id:"chemo_cycleNumber",modelValue:s(t).chemo_cycleNumber,"onUpdate:modelValue":e[6]||(e[6]=o=>s(t).chemo_cycleNumber=o),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),a(i,{class:"mt-2",message:s(t).errors.chemo_cycleNumber},null,8,["message"])]),l("div",null,[a(n,{for:"chemo_status",value:"Chemotherapy Status"}),f(l("select",{id:"chemo_status","onUpdate:modelValue":e[7]||(e[7]=o=>s(t).chemo_status=o),class:"mt-1 block w-full"},e[19]||(e[19]=[l("option",{value:"",disabled:""},"Select Chemotherapy Status",-1),l("option",{value:"Ongoing"},"Ongoing",-1),l("option",{value:"Completed"},"Completed",-1),l("option",{value:"Not Completed"},"Not Completed",-1)]),512),[[b,s(t).chemo_status]]),a(i,{class:"mt-2",message:s(t).errors.chemo_status},null,8,["message"])]),l("div",null,[a(n,{for:"chemo_notes",value:"Chemotherapy Notes"}),a(y,{id:"chemo_notes",modelValue:s(t).chemo_notes,"onUpdate:modelValue":e[8]||(e[8]=o=>s(t).chemo_notes=o),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),a(i,{class:"mt-2",message:s(t).errors.chemo_notes},null,8,["message"])]),l("div",null,[a(n,{for:"chemo_isCompleted",value:"Chemotheraphy Completed"}),l("div",Q,[l("label",z,[f(l("input",{type:"radio",name:"chemo_isCompleted",value:!0,"onUpdate:modelValue":e[9]||(e[9]=o=>s(t).chemo_isCompleted=o),class:"form-radio"},null,512),[[R,s(t).chemo_isCompleted]]),e[20]||(e[20]=l("span",{class:"custom-radio"},null,-1)),e[21]||(e[21]=l("span",{class:"ml-2"},"Yes",-1))]),l("label",J,[f(l("input",{type:"radio",name:"chemo_isCompleted",value:!1,"onUpdate:modelValue":e[10]||(e[10]=o=>s(t).chemo_isCompleted=o),class:"form-radio"},null,512),[[R,s(t).chemo_isCompleted]]),e[22]||(e[22]=l("span",{class:"custom-radio"},null,-1)),e[23]||(e[23]=l("span",{class:"ml-2"},"No",-1))])]),a(i,{class:"mt-2",message:s(t).errors.chemo_isCompleted},null,8,["message"])]),l("div",null,[a(n,{for:"chemo_facility"},{default:c(()=>e[24]||(e[24]=[p(" Chemotherapy Facility ")])),_:1}),f(l("select",{id:"chemo_facility","onUpdate:modelValue":e[11]||(e[11]=o=>s(t).chemo_facility=o),class:"mt-1 block w-full",required:""},[e[25]||(e[25]=l("option",{value:"",disabled:""},"Select facility",-1)),(d(!0),_(U,null,N($.value,o=>(d(),_("option",{key:o.hospital_id,value:o.hospital_id},k(o.hospital_name),9,K))),128))],512),[[b,s(t).chemo_facility]]),a(i,{class:"mt-2",message:s(t).errors.chemo_facility},null,8,["message"])]),l("div",null,[a(n,{for:"chemo_doctor"},{default:c(()=>e[26]||(e[26]=[p(" Chemotherapy Doctor ")])),_:1}),f(l("select",{id:"chemo_doctor","onUpdate:modelValue":e[12]||(e[12]=o=>s(t).chemo_doctor=o),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:"",disabled:m.isLoading},[l("option",X,k(m.isLoading?"Loading doctors...":"Select a Doctor"),1),(d(!0),_(U,null,N(P.value,o=>(d(),_("option",{key:o.doctor_id,value:o.doctor_id},k("Dr. "+`${o.user.firstname} ${o.user.middlename} ${o.user.lastname}`.toLowerCase().split(" ").map(h=>h.charAt(0).toUpperCase()+h.slice(1)).join(" ")),9,Z))),128))],8,W),[[b,s(t).chemo_doctor]]),a(i,{class:"mt-2",message:s(t).errors.chemo_doctor},null,8,["message"]),m.error?(d(),_("p",ee,k(m.error),1)):S("",!0)]),l("div",oe,[V.value?(d(),D(x,{key:0,onClick:j,class:"ms-4"},{default:c(()=>e[27]||(e[27]=[p(" Back ")])),_:1})):S("",!0),V.value?S("",!0):(d(),D(x,{key:1,onClick:e[13]||(e[13]=o=>B.value=1),class:"ms-4"},{default:c(()=>e[28]||(e[28]=[p(" Submit ")])),_:1})),a(x,{onClick:m.nextStep,class:"ms-4"},{default:c(()=>e[29]||(e[29]=[p(" Submit and Proceed ")])),_:1},8,["onClick"])])],32)]),_:1}))}},he=G(te,[["__scopeId","data-v-87a3cc49"]]);export{he as default};
