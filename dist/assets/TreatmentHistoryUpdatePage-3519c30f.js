import{Q as $,d as g,T as A,p as k,l as D,o as v,e as V,b as s,u as l,w as c,F as E,m as _,Z as F,a,g as x,q as o,A as h,B as I,f as w,v as B,x as d,k as J,c as j}from"./app-42536e63.js";import{_ as u}from"./InputError-d893a523.js";import{_ as p}from"./InputLabel-ff26f500.js";import{_ as L}from"./PrimaryButton-cd95b478.js";import{_ as b}from"./TextInput-d9580142.js";import{A as Y}from"./Alert-e9943a8b.js";import q from"./Layout-1c104a2a.js";import{d as Q}from"./index-189aeacd.js";import{_ as Z}from"./_plugin-vue_export-helper-c27b6911.js";import"./DropdownLink-ed97a0d6.js";/* empty css                                                               */const z={class:"mt-1 flex flex-col gap-2"},G={class:"inline-flex items-center"},K={class:"inline-flex items-center mt-1"},W={class:"inline-flex items-center mt-1"},X={class:"inline-flex items-center mt-1"},ee={key:0,class:"mt-3"},te={class:"mt-1 flex flex-col gap-2"},ae={class:"inline-flex items-center"},ne={class:"inline-flex items-center mt-1"},le={class:"inline-flex items-center mt-1"},se={class:"inline-flex items-center"},re={class:"inline-flex items-center mt-1"},oe={class:"inline-flex items-center mt-1"},ie={class:"inline-flex items-center mt-1"},me={key:0,class:"mt-3"},pe={class:"flex items-center justify-center mt-4"},de={__name:"TreatmentHistoryUpdatePage",setup(ue){const{url:S,props:T}=$(),y=S.split("/");let i=y[y.length-1],m;i=parseInt(i,10);const C=T.auth.user.user_id,O=T.auth.user.email,f=g({show:!1,message:"",type:""});y.length===4&&(m=parseInt(y[2],10),i=parseInt(y[3],10)),console.log("Patient ID:",i);const t=A({lastname:"",email:"",treatment_purpose:"",other_treatment_purpose:"",primary_type:"",primary_treatment:"",initial_treatment_date:"",planned_additional_treatment:[],other_planned_additional_treatment:""});k(t,r=>{console.log("Updated form:",JSON.parse(JSON.stringify(r)))},{deep:!0}),k(()=>[t.lastname,t.email],async(r,e)=>{t.lastname&&t.email&&await R()},{deep:!0}),g(null),g({lastname:"",email:""});const P=async()=>{try{const e=(await _.get("/api/all-patients")).data.find(n=>n.patient_id===i);if(console.log("Found patient:",e),e){const n=e.user;t.lastname=n.lastname,t.email=n.email}}catch(r){console.error("Failed to fetch patient info:",r)}},R=async()=>{try{const e=(await _.get("/api/find-patient",{params:{lastname:t.lastname,email:t.email}})).data;e?(i=e.patient_id,console.log(i),console.log(m)):console.log("Failed to fetch patient ID")}catch(r){console.log("Failed to fetch patient ID:",r)}},U=(r,e)=>{console.log(r);const n=r.rxtypes[e];n&&(n.rxtype_chemotherapy===1&&t.planned_additional_treatment.push("Chemotherapy"),n.rxtype_hormonaltherapy===1&&t.planned_additional_treatment.push("Hormonal Therapy"),n.rxtype_immunotherapy===1&&t.planned_additional_treatment.push("Immunotherapy/Cryotherapy"),n.rxtype_radiotherapy===1&&t.planned_additional_treatment.push("Radiotherapy"),n.rxtype_surgery===1&&t.planned_additional_treatment.push("Surgery"),n.rxtype_others===1&&t.planned_additional_treatment.push("Others"))},N=async r=>{try{const n=(await _.get(`/api/patient/${r}/treatments`)).data;t.treatment_purpose=n.treatments[m].treatment_purpose,console.log("Treatment Info:",n),t.treatment_purpose==="Others"&&(t.other_treatment_purpose=n.treatments[m].treatment_other_purpose),t.primary_type=n.treatments[m].treatment_primaryRxType,t.primary_treatment=n.treatments[m].treatment_primaryRxName,t.initial_treatment_date=n.treatments[m].treatment_initialRxDate,U(n,m),t.planned_additional_treatment.includes("Others")&&(t.other_planned_additional_treatment=n.rxtypes[m].rxtype_other_treatment),console.log(n)}catch(e){console.error("Failed to fetch patient:",e)}};D(async()=>{await P(),await N(i),U(m)});const H=g(0),M=async()=>{try{f.value.show=!1,console.log(t);const r=await _.put(`/api/treatment/update/primary/${i}`,t),e=await _.get(`/api/get-patient/${i}`);console.log(e),await _.post("/api/create-notification-log",{from:O,to:e.data.user.email,subject:"Treatment Information Updated",message:"The patient's PRIMARY treatment is updated",senderId:C,receiverId:e.data.user.user_id,notificationStatus:1,notificationType:5}),r.status===200?(f.value={show:!0,message:"Success! Treatment history updated.",type:"success"},Q.Inertia.get("/search")):console.error("Error updating details:",r.status)}catch(r){console.error("Error updating treatment record:",r)}};return k(t,r=>{console.log("Updated form:",JSON.parse(JSON.stringify(r)))},{deep:!0}),(r,e)=>(v(),V(E,null,[s(l(F),{title:"Treatment History"}),s(q,null,{default:c(()=>[e[39]||(e[39]=a("div",{class:"page-heading"},[a("h1",{class:"main-heading"},"TREATMENT HISTORY")],-1)),a("form",{onSubmit:J(M,["prevent"]),class:"form-container"},[a("div",null,[s(p,{for:"lastname"},{default:c(()=>e[19]||(e[19]=[x(" Last Name "),a("span",{class:"red-asterisk"},"*",-1)])),_:1}),s(b,{id:"lastname",modelValue:l(t).lastname,"onUpdate:modelValue":e[0]||(e[0]=n=>l(t).lastname=n),type:"text",class:"mt-1 block w-full",autofocus:"",autocomplete:"lastname",disabled:""},null,8,["modelValue"]),s(u,{class:"mt-2",message:l(t).errors.lastname},null,8,["message"])]),a("div",null,[s(p,{for:"email"},{default:c(()=>e[20]||(e[20]=[x(" Email Address "),a("span",{class:"red-asterisk"},"*",-1)])),_:1}),s(b,{id:"email",modelValue:l(t).email,"onUpdate:modelValue":e[1]||(e[1]=n=>l(t).email=n),type:"email",class:"mt-1 block w-full",autocomplete:"username",disabled:""},null,8,["modelValue"]),s(u,{class:"mt-2",message:l(t).errors.email},null,8,["message"])]),a("div",null,[s(p,{for:"treatment_purpose",value:"Treatment Purpose"}),a("div",z,[a("label",G,[o(a("input",{type:"radio",name:"treatment_purpose",value:"Curative-complete","onUpdate:modelValue":e[2]||(e[2]=n=>l(t).treatment_purpose=n),class:"form-radio"},null,512),[[h,l(t).treatment_purpose]]),e[21]||(e[21]=a("span",{class:"custom-radio"},null,-1)),e[22]||(e[22]=a("span",{class:"ml-2"},"Curative-complete",-1))]),a("label",K,[o(a("input",{type:"radio",name:"treatment_purpose",value:"Curative-incomplete","onUpdate:modelValue":e[3]||(e[3]=n=>l(t).treatment_purpose=n),class:"form-radio"},null,512),[[h,l(t).treatment_purpose]]),e[23]||(e[23]=a("span",{class:"custom-radio"},null,-1)),e[24]||(e[24]=a("span",{class:"ml-2"},"Curative-incomplete",-1))]),a("label",W,[o(a("input",{type:"radio",name:"treatment_purpose",value:"Palliative only","onUpdate:modelValue":e[4]||(e[4]=n=>l(t).treatment_purpose=n),class:"form-radio"},null,512),[[h,l(t).treatment_purpose]]),e[25]||(e[25]=a("span",{class:"custom-radio"},null,-1)),e[26]||(e[26]=a("span",{class:"ml-2"},"Palliative only",-1))]),a("label",X,[o(a("input",{type:"radio",name:"treatment_purpose",value:"Others","onUpdate:modelValue":e[5]||(e[5]=n=>l(t).treatment_purpose=n),class:"form-radio"},null,512),[[h,l(t).treatment_purpose]]),e[27]||(e[27]=a("span",{class:"custom-radio"},null,-1)),e[28]||(e[28]=a("span",{class:"ml-2"},"Others",-1))])]),l(t).treatment_purpose.includes("Others")?(v(),V("div",ee,[s(p,{for:"other_treatment_purpose",value:"Specify"}),o(a("input",{id:"other_treatment_purpose","onUpdate:modelValue":e[6]||(e[6]=n=>l(t).other_treatment_purpose=n),type:"text",class:"mt-1 block w-full",placeholder:"Specify treatment purpose"},null,512),[[I,l(t).other_treatment_purpose]])])):w("",!0),s(u,{class:"mt-2",message:l(t).errors.treatment_purpose},null,8,["message"])]),a("div",null,[s(p,{for:"primary_type",value:"Primary Type"}),o(a("select",{id:"primary_type","onUpdate:modelValue":e[7]||(e[7]=n=>l(t).primary_type=n),class:"mt-1 block w-full"},e[29]||(e[29]=[a("option",{value:"",disabled:""},"Select Primary Type",-1),a("option",{value:"Surgery"},"Surgery",-1),a("option",{value:"Radiotherapy"},"Radiotherapy",-1),a("option",{value:"Chemotherapy"},"Chemotherapy",-1),a("option",{value:"Immunotherapy/Cryotherapy"},"Immunotherapy/Cryotherapy",-1),a("option",{value:"Hormonal Therapy"},"Hormonal Therapy",-1),a("option",{value:"Unknown"},"Unknown",-1)]),512),[[B,l(t).primary_type]]),s(u,{message:l(t).errors.primary_type},null,8,["message"])]),a("div",null,[s(p,{for:"primary_treatment"},{default:c(()=>e[30]||(e[30]=[x(" Primary Treatment ")])),_:1}),s(b,{id:"primary_treatment",modelValue:l(t).primary_treatment,"onUpdate:modelValue":e[8]||(e[8]=n=>l(t).primary_treatment=n),type:"primary_treatment",class:"mt-1 block w-full"},null,8,["modelValue"]),s(u,{class:"mt-2",message:l(t).errors.primary_treatment},null,8,["message"])]),a("div",null,[s(p,{for:"initial_treatment_date",value:"Initial Treatment Date"}),s(b,{id:"initial_treatment_date",modelValue:l(t).initial_treatment_date,"onUpdate:modelValue":e[9]||(e[9]=n=>l(t).initial_treatment_date=n),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),s(u,{class:"mt-2",message:l(t).errors.initial_treatment_date},null,8,["message"])]),a("div",null,[s(p,{for:"planned_additional_treatment",value:"Planned Additional Treatment"}),a("div",te,[a("label",ae,[o(a("input",{type:"checkbox",value:"Surgery","onUpdate:modelValue":e[10]||(e[10]=n=>l(t).planned_additional_treatment=n),class:"form-checkbox"},null,512),[[d,l(t).planned_additional_treatment]]),e[31]||(e[31]=a("span",{class:"ml-2"},"Surgery",-1))]),a("label",ne,[o(a("input",{type:"checkbox",value:"Radiotherapy","onUpdate:modelValue":e[11]||(e[11]=n=>l(t).planned_additional_treatment=n),class:"form-checkbox"},null,512),[[d,l(t).planned_additional_treatment]]),e[32]||(e[32]=a("span",{class:"ml-2"},"Radiotherapy",-1))]),a("label",le,[o(a("input",{type:"checkbox",value:"Chemotherapy","onUpdate:modelValue":e[12]||(e[12]=n=>l(t).planned_additional_treatment=n),class:"form-checkbox"},null,512),[[d,l(t).planned_additional_treatment]]),e[33]||(e[33]=a("span",{class:"ml-2"},"Chemotherapy",-1))]),a("label",se,[o(a("input",{type:"checkbox",value:"Immunotherapy/Cryotherapy","onUpdate:modelValue":e[13]||(e[13]=n=>l(t).planned_additional_treatment=n),class:"form-checkbox"},null,512),[[d,l(t).planned_additional_treatment]]),e[34]||(e[34]=a("span",{class:"ml-2"},"Immunotherapy/Cryotherapy",-1))]),a("label",re,[o(a("input",{type:"checkbox",value:"Hormonal Therapy","onUpdate:modelValue":e[14]||(e[14]=n=>l(t).planned_additional_treatment=n),class:"form-checkbox"},null,512),[[d,l(t).planned_additional_treatment]]),e[35]||(e[35]=a("span",{class:"ml-2"},"Hormonal Therapy",-1))]),a("label",oe,[o(a("input",{type:"checkbox",value:"Unknown","onUpdate:modelValue":e[15]||(e[15]=n=>l(t).planned_additional_treatment=n),class:"form-checkbox"},null,512),[[d,l(t).planned_additional_treatment]]),e[36]||(e[36]=a("span",{class:"ml-2"},"Unknown",-1))]),a("label",ie,[o(a("input",{type:"checkbox",value:"Others","onUpdate:modelValue":e[16]||(e[16]=n=>l(t).planned_additional_treatment=n),class:"form-checkbox"},null,512),[[d,l(t).planned_additional_treatment]]),e[37]||(e[37]=a("span",{class:"ml-2"},"Others",-1))])]),l(t).planned_additional_treatment.includes("Others")?(v(),V("div",me,[s(p,{for:"other_planned_additional_treatment",value:"Specify"}),o(a("input",{id:"other_planned_additional_treatment","onUpdate:modelValue":e[17]||(e[17]=n=>l(t).other_planned_additional_treatment=n),type:"text",class:"mt-1 block w-full",placeholder:"Specify other planned additional treatment"},null,512),[[I,l(t).other_planned_additional_treatment]])])):w("",!0),s(u,{class:"mt-2",message:l(t).errors.planned_additional_treatment},null,8,["message"])]),a("div",pe,[s(L,{onClick:e[18]||(e[18]=n=>H.value=1),class:"ms-4"},{default:c(()=>e[38]||(e[38]=[x(" Update Details ")])),_:1})])],32),f.value.show?(v(),j(Y,{key:0,message:f.value.message,type:f.value.type},null,8,["message","type"])):w("",!0)]),_:1})],64))}},we=Z(de,[["__scopeId","data-v-3c886a03"]]);export{we as default};
