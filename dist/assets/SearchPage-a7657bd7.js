import te from"./Layout-1c104a2a.js";import{a as D,s as ae}from"./column.esm-e576acfe.js";import{ac as se,ad as ne,ae as re,af as oe,ag as ie,ah as le,ai as ce,F as H,aj as de,ak as ue,al as pe,am as fe,U as me,an as be,ao as he,H as ve,aa as ge,ap as ye,aq as Se,ar as _e,as as we,at as Te,au as Ce,av as Pe,aw as ke,ax as Re,s as F,ay as Ee,c as V,f as y,e as S,a as i,az as De,aA as xe,aB as Ne,aC as $e,a1 as Ie,i as Le,g as k,b as d,aD as Me,aE as Oe,aF as Ue,aG as Ae,aH as He,aI as Fe,aJ as Ve,aK as Be,aL as je,aM as ze,aN as We,aO as qe,aP as Ke,aQ as Ge,O as Qe,aR as Je,aS as Ye,aT as Xe,a7 as Ze,aU as et,aV as tt,aW as at,aX as st,aY as nt,aZ as rt,a_ as ot,a$ as it,b0 as lt,b1 as ct,b2 as dt,b3 as ut,b4 as pt,b5 as ft,b6 as mt,C as bt,b7 as ht,b8 as vt,b9 as gt,ba as yt,bb as St,bc as _t,R as wt,z as Tt,n as Ct,a3 as Pt,a9 as kt,bd as Rt,be as Et,bf as Dt,bg as xt,bh as Nt,bi as $t,l as B,bj as It,bk as Lt,bl as Mt,bm as Ot,E as Ut,bn as At,bo as Ht,o as f,bp as Ft,bq as Vt,br as Bt,bs as jt,bt as zt,ab as Wt,N as qt,d as m,bu as Kt,bv as Gt,h as Qt,r as Jt,y as Yt,$ as Xt,a0 as Zt,bw as ea,bx as ta,by as aa,bz as sa,bA as na,bB as ra,bC as oa,bD as ia,bE as la,bF as ca,bG as da,t as _,bH as ua,a2 as pa,bI as fa,bJ as ma,bK as ba,bL as ha,bM as va,bN as ga,u as b,bO as ya,bP as Sa,bQ as _a,bR as wa,bS as Ta,bT as Ca,bU as Pa,bV as ka,J as Ra,bW as Ea,bX as Da,x as xa,bY as Na,A as $a,v as Ia,B as La,G as Ma,bZ as Oa,b_ as Ua,p as Aa,D as j,b$ as Ha,c0 as Fa,c1 as Va,w as p,c2 as Ba,q as ja,a8 as za,c3 as Wa,k as qa,c4 as Ka,c5 as Ga,c6 as Qa,c7 as Ja,Q as A,m as $}from"./app-42536e63.js";import{d as I}from"./index-189aeacd.js";import Ya from"./PatientInfoPage-6d459384.js";import Xa from"./DiseaseInfoPage-cda660dc.js";import Za from"./TreatmentHistoryInfoPage-ad5d78b3.js";import{_ as es}from"./_plugin-vue_export-helper-c27b6911.js";import"./DropdownLink-ed97a0d6.js";/* empty css                                                               *//**
* vue v3.5.2
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const ts=()=>{},as=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:se,BaseTransitionPropsValidators:ne,Comment:re,DeprecationTypes:oe,EffectScope:ie,ErrorCodes:le,ErrorTypeStrings:ce,Fragment:H,KeepAlive:de,ReactiveEffect:ue,Static:pe,Suspense:fe,Teleport:me,Text:be,TrackOpTypes:he,Transition:ve,TransitionGroup:ge,TriggerOpTypes:ye,VueElement:Se,assertNumber:_e,callWithAsyncErrorHandling:we,callWithErrorHandling:Te,camelize:Ce,capitalize:Pe,cloneVNode:ke,compatUtils:Re,compile:ts,computed:F,createApp:Ee,createBlock:V,createCommentVNode:y,createElementBlock:S,createElementVNode:i,createHydrationRenderer:De,createPropsRestProxy:xe,createRenderer:Ne,createSSRApp:$e,createSlots:Ie,createStaticVNode:Le,createTextVNode:k,createVNode:d,customRef:Me,defineAsyncComponent:Oe,defineComponent:Ue,defineCustomElement:Ae,defineEmits:He,defineExpose:Fe,defineModel:Ve,defineOptions:Be,defineProps:je,defineSSRCustomElement:ze,defineSlots:We,devtools:qe,effect:Ke,effectScope:Ge,getCurrentInstance:Qe,getCurrentScope:Je,getCurrentWatcher:Ye,getTransitionRawChildren:Xe,guardReactiveProps:Ze,h:et,handleError:tt,hasInjectionContext:at,hydrate:st,hydrateOnIdle:nt,hydrateOnInteraction:rt,hydrateOnMediaQuery:ot,hydrateOnVisible:it,initCustomFormatter:lt,initDirectivesForSSR:ct,inject:dt,isMemoSame:ut,isProxy:pt,isReactive:ft,isReadonly:mt,isRef:bt,isRuntimeOnly:ht,isShallow:vt,isVNode:gt,markRaw:yt,mergeDefaults:St,mergeModels:_t,mergeProps:wt,nextTick:Tt,normalizeClass:Ct,normalizeProps:Pt,normalizeStyle:kt,onActivated:Rt,onBeforeMount:Et,onBeforeUnmount:Dt,onBeforeUpdate:xt,onDeactivated:Nt,onErrorCaptured:$t,onMounted:B,onRenderTracked:It,onRenderTriggered:Lt,onScopeDispose:Mt,onServerPrefetch:Ot,onUnmounted:Ut,onUpdated:At,onWatcherCleanup:Ht,openBlock:f,popScopeId:Ft,provide:Vt,proxyRefs:Bt,pushScopeId:jt,queuePostFlushCb:zt,reactive:Wt,readonly:qt,ref:m,registerRuntimeCompiler:Kt,render:Gt,renderList:Qt,renderSlot:Jt,resolveComponent:Yt,resolveDirective:Xt,resolveDynamicComponent:Zt,resolveFilter:ea,resolveTransitionHooks:ta,setBlockTracking:aa,setDevtoolsHook:sa,setTransitionHooks:na,shallowReactive:ra,shallowReadonly:oa,shallowRef:ia,ssrContextKey:la,ssrUtils:ca,stop:da,toDisplayString:_,toHandlerKey:ua,toHandlers:pa,toRaw:fa,toRef:ma,toRefs:ba,toValue:ha,transformVNodeArgs:va,triggerRef:ga,unref:b,useAttrs:ya,useCssModule:Sa,useCssVars:_a,useHost:wa,useId:Ta,useModel:Ca,useSSRContext:Pa,useShadowRoot:ka,useSlots:Ra,useTemplateRef:Ea,useTransitionState:Da,vModelCheckbox:xa,vModelDynamic:Na,vModelRadio:$a,vModelSelect:Ia,vModelText:La,vShow:Ma,version:Oa,warn:Ua,watch:Aa,watchEffect:j,watchPostEffect:Ha,watchSyncEffect:Fa,withAsyncContext:Va,withCtx:p,withDefaults:Ba,withDirectives:ja,withKeys:za,withMemo:Wa,withModifiers:qa,withScopeId:Ka},Symbol.toStringTag,{value:"Module"})),ss=Ga(as);var z;function W(t){return t&&typeof t=="object"&&"default"in t?t.default:t}W(Qa);var L=ss;W(Ja);L.ref(null);L.ref({});L.ref(null);var ns={props:{title:{type:String,required:!1}},data:function(){return{provider:this.$headManager.createProvider()}},beforeUnmount:function(){this.provider.disconnect()},methods:{isUnaryTag:function(t){return["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"].indexOf(t.type)>-1},renderTagStart:function(t){t.props=t.props||{},t.props.inertia=t.props["head-key"]!==void 0?t.props["head-key"]:"";var r=Object.keys(t.props).reduce(function(a,o){var h=t.props[o];return["key","head-key"].includes(o)?a:h===""?a+" "+o:a+" "+o+'="'+h+'"'},"");return"<"+t.type+r+">"},renderTagChildren:function(t){var r=this;return typeof t.children=="string"?t.children:t.children.reduce(function(a,o){return a+r.renderTag(o)},"")},renderTag:function(t){if(t.type.toString()==="Symbol(Text)")return t.children;if(t.type.toString()==="Symbol()"||t.type.toString()==="Symbol(Comment)")return"";var r=this.renderTagStart(t);return t.children&&(r+=this.renderTagChildren(t)),this.isUnaryTag(t)||(r+="</"+t.type+">"),r},addTitleElement:function(t){return this.title&&!t.find(function(r){return r.startsWith("<title")})&&t.push("<title inertia>"+this.title+"</title>"),t},renderNodes:function(t){var r=this;return this.addTitleElement(t.flatMap(function(a){return a.type.toString()==="Symbol(Fragment)"?a.children:a}).map(function(a){return r.renderTag(a)}).filter(function(a){return a}))}},render:function(){this.provider.update(this.renderNodes(this.$slots.default?this.$slots.default():[]))}};z=ns;const rs={class:"page-heading"},os={class:"main-heading"},is={key:0},ls={class:"buttons-section"},cs={class:"column"},ds={class:"column"},us={key:1},ps={key:2},fs={key:3},ms={__name:"SearchPage",setup(t){const r=m([]),a=m(null),o=m(null),h=m(""),{url:M}=A();if(M){const n=new URL(M,window.location.origin);h.value=n.searchParams.get("name")}else console.error("URL is undefined");const{props:q}=A(),K=q.auth.user.user_id,R=m(null),G=async n=>{try{let e=await $.get(`/api/doctor-profile/${n}`);R.value=e.data}catch(e){console.error(`Failed to fetch doctor with userId ${n}:`,e)}},Q=async n=>{try{let e=await $.get(`/api/doctors/${n}/patients`);r.value=e.data}catch(e){console.error("Failed to fetch patients:",e)}},J=async n=>{try{for(let e=0;e<n.value.length;e++){const c=n.value[e];if(c.patient_id){const s=async(u,E="")=>{try{return(await $.get(u)).data}catch(v){if(v.response&&v.response.status===404)return console.warn(`404 Not Found: ${u}`),E;throw v}},l=await s(`/api/latestdisease/${c.patient_id}/profile`),w=await s(`/api/checkups/${c.patient_id}`),T=await s(`/api/patients/${c.patient_id}/survey-responses`),C=await s(`/api/patients/${c.patient_id}/latest-labs-submitted`),P=m(null);if(w.checkup&&T&&C){const u=[];u.push({date:new Date(w.checkup.checkup_date),type:"Consult"}),u.push({date:new Date(T.surveyResponse_date),type:"Survey Response"}),u.push({date:new Date(C.labSubmission_date),type:"Laboratory"});const E=u.reduce((g,U)=>U.date>g?U.date:g,new Date(0)),v=u.filter(g=>g.date.getTime()===E.getTime());P.value={date:E,types:v.map(g=>g.type).join(", ")}}n.value[e]={...c,disease:l||"",latestEncounter:P.value||""}}}}catch(e){console.error("Failed to fetch checkups or disease profiles:",e)}};B(async()=>{await G(K),await Q(R==null?void 0:R.value.doctor_id),await J(N)});const x=n=>{a.value?o.value=n:alert("Please select a patient first.")},N=F(()=>{var n;return h.value?(n=r.value)==null?void 0:n.filter(e=>{var w,T,C,P;const c=((T=(w=e.user)==null?void 0:w.firstname)==null?void 0:T.toLowerCase())||"",s=((P=(C=e.user)==null?void 0:C.lastname)==null?void 0:P.toLowerCase())||"",l=h.value.toLowerCase();return c.includes(l)||s.includes(l)}):r.value}),Y=()=>{a.value?I.Inertia.visit(`/schedconsult/${a.value.patient_id}`):alert("Please select a patient first.")},X=()=>{a.value?I.Inertia.visit(`/consult/${a.value.patient_id}`):alert("Please select a patient first.")},Z=()=>{a.value?I.Inertia.visit(`/message/${a.value.patient_id}`):alert("Please select a patient first.")};j(async()=>{console.log(a.value.patient_id)});function O(n){return n?n.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "):""}const ee=n=>{const e=new Date(n);return isNaN(e)?"":e.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})};return(n,e)=>(f(),S(H,null,[d(b(z),{title:"Search"}),d(te,null,{default:p(()=>{var c;return[i("div",rs,[i("h1",os,_(o.value?o.value.toUpperCase():"SEARCH"),1)]),o.value?y("",!0):(f(),S("div",is,[(c=N.value)!=null&&c.length?(f(),V(b(ae),{key:0,value:N.value,responsiveLayout:"scroll",paginator:!0,rows:3,rowsPerPageOptions:[3,5,10,25],paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",selectionMode:"single",selection:a.value,"onUpdate:selection":e[0]||(e[0]=s=>a.value=s)},{header:p(()=>e[7]||(e[7]=[i("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},[i("h2",{class:"table-title m-0"},"Submitted Workup")],-1)])),default:p(()=>[d(b(D),{field:"user.firstname",header:"Name",sortable:!0},{body:p(s=>[k(_(O(s.data.user.firstname)+" "+O(s.data.user.lastname)),1)]),_:1}),d(b(D),{field:"diagnosis",header:"Diagnosis",sortable:!0},{body:p(s=>{var l;return[k(_(((l=s.data.disease)==null?void 0:l.disease_fullDiagnosis)||""),1)]}),_:1}),d(b(D),{field:"last_encounter_type",header:"Last Encounter Type",sortable:!0},{body:p(s=>{var l;return[k(_(((l=s.data.latestEncounter)==null?void 0:l.types)||""),1)]}),_:1}),d(b(D),{field:"last_encounter_date",header:"Last Encounter Date",sortable:!0},{body:p(s=>{var l;return[k(_(ee((l=s.data.latestEncounter)==null?void 0:l.date)||""),1)]}),_:1})]),_:1},8,["value","selection"])):y("",!0),i("div",ls,[i("div",cs,[i("button",{class:"bigger-btn",onClick:e[1]||(e[1]=s=>x("Patient Information"))},"PATIENT INFO"),i("button",{class:"bigger-btn",onClick:e[2]||(e[2]=s=>x("Disease Profile"))},"DISEASE PROFILE"),i("button",{class:"bigger-btn",onClick:e[3]||(e[3]=s=>Y())},"SCHED CONSULT")]),i("div",ds,[i("button",{class:"bigger-btn",onClick:e[4]||(e[4]=s=>X())},"CONSULT"),i("button",{class:"bigger-btn",onClick:e[5]||(e[5]=s=>x("Treatment History"))},"TREATMENT HISTORY"),i("button",{class:"bigger-btn",onClick:e[6]||(e[6]=s=>Z())},"MESSAGE")])])])),o.value==="Patient Information"?(f(),S("div",us,[d(Ya,{patient:a.value},null,8,["patient"])])):y("",!0),o.value==="Disease Profile"?(f(),S("div",ps,[d(Xa,{patient:a.value},null,8,["patient"])])):y("",!0),o.value==="Treatment History"?(f(),S("div",fs,[d(Za,{patient:a.value},null,8,["patient"])])):y("",!0)]}),_:1})],64))}},Ps=es(ms,[["__scopeId","data-v-ad08eafc"]]);export{Ps as default};
