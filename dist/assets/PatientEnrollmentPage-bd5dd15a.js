import{d as g,Q as K,l as q,T as W,m as f,p as N,o as p,e as c,b as t,u as l,w as d,F as V,Z as X,a as o,g as u,f as D,q as b,v,h as k,t as w,n as O,k as Y}from"./app-42536e63.js";import{_ as P}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as i}from"./InputError-d893a523.js";import{_ as n}from"./InputLabel-ff26f500.js";import{_ as T}from"./PrimaryButton-cd95b478.js";import{_ as m}from"./TextInput-d9580142.js";import h from"./Layout-1c104a2a.js";import"./index-189aeacd.js";import"./DropdownLink-ed97a0d6.js";/* empty css                                                               */const ee={key:0},se={key:1},le=["value"],ae=["value"],re=["value"],te=["value"],oe={class:"flex items-center justify-center mt-4"},de={__name:"PatientEnrollmentPage",setup(ie){const _=g(0),C=g(0),{url:M,props:j}=K();if(M){const r=new URL(M,window.location.origin);_.value=r.searchParams.get("userId")}else console.error("URL is undefined");const G=async r=>{try{let e=await f.get(`/api/get-user/${r}`);C.value=e.data}catch(e){console.error("Failed to fetch user:",e)}};q(async()=>{await G(_.value)});const s=W({firstname:"",middlename:"",lastname:"",email:"",contact_number:"",password:"",password_confirmation:"",birthday:"",birthplace:"",gender:"",marital_status:"",address_brgy:"",address_street:"",address_number:"",address_zipcode:"",region_id:null,province_id:null,city_id:null,municipality_id:null}),$=g([]),E=g([]),x=g([]),U=g([]);q(async()=>{const r=await f.get("/api/regions");$.value=r.data}),N(C,r=>{var e,a,z,B,F,L,A,R;r&&(s.firstname=r.firstname||"",s.middlename=r.middlename||"",s.lastname=r.lastname||"",s.email=r.email||"",s.contact_number=r.contact_number||"",s.birthday=r.birthday||"",s.birthplace=r.birthplace||"",s.gender=r.gender||"",s.marital_status=r.marital_status||"",s.address_brgy=((e=r.address)==null?void 0:e.address_brgy)||"",s.address_street=((a=r.address)==null?void 0:a.address_street)||"",s.address_number=((z=r.address)==null?void 0:z.address_number)||"",s.address_zipcode=((B=r.address)==null?void 0:B.address_zipcode)||"",s.region_id=((F=r.address)==null?void 0:F.region_id)||null,s.province_id=((L=r.address)==null?void 0:L.province_id)||null,s.city_id=((A=r.address)==null?void 0:A.city_id)||null,s.municipality_id=((R=r.address)==null?void 0:R.municipality_id)||null)},{immediate:!0}),N(()=>s.region_id,async r=>{if(r){const e=await f.get(`/api/provinces/${r}`);E.value=e.data,x.value=[],U.value=[]}}),N(()=>s.province_id,async r=>{if(r){const e=await f.get(`/api/cities/${r}`);x.value=e.data;const a=await f.get(`/api/municipalities/${r}`);U.value=a.data}});function S(){return/^09\d{9}$/.test(s.contact_number)?(s.errors.contact_number=null,!0):(s.errors.contact_number="Format must be in 09xxxxxxxxx.",!1)}let Z=j.auth.user.user_id;const I=g(null);let y=g(0);const H=async r=>{try{let e=await f.get(`/api/doctor-profile/${r}`);I.value=e.data,y.value=I.value.doctor_id,console.log(y.value)}catch(e){console.error(`Failed to fetch doctor with userId ${r}:`,e)}};q(async()=>{await H(Z)});const Q=async()=>{if(S())try{const r=await f.post(route("enrollPatient"),s);if(r.status===200){const e=r.data.patient_id;console.log(e),console.log(y.value),await f.post("/api/onboard",{patientId:e,doctorId:y.value}),s.reset(),alert("Patient enrolled successfully.")}}catch(r){r.response&&r.response.data.errors?Object.keys(r.response.data.errors).forEach(e=>{s.errors[e]=r.response.data.errors[e]}):console.error("An error occurred:",r)}},J=async()=>{if(S())try{const r=await f.post(route("enrollPatient"),s);if(r.status===200){const e=r.data.patient_id;console.log(e),await f.post("/api/onboard",{patientId:e,doctorId:y.value}),s.reset("password","password_confirmation"),window.location.href=`/disease-profile/${e}`}}catch(r){r.response&&r.response.data.errors?Object.keys(r.response.data.errors).forEach(e=>{s.errors[e]=r.response.data.errors[e]}):console.error("An error occurred:",r)}};return(r,e)=>(p(),c(V,null,[t(l(X),{title:"Patient Enrollment"}),t(h,null,{default:d(()=>[e[44]||(e[44]=o("div",{class:"page-heading"},[o("h1",{class:"main-heading"},"PATIENT ENROLLMENT")],-1)),o("form",{onSubmit:e[19]||(e[19]=Y((...a)=>r.submit&&r.submit(...a),["prevent"])),class:"form-container"},[o("div",null,[t(n,{for:"lastname"},{default:d(()=>e[20]||(e[20]=[u(" Last Name "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"lastname",modelValue:l(s).lastname,"onUpdate:modelValue":e[0]||(e[0]=a=>l(s).lastname=a),type:"text",class:"mt-1 block w-full",required:"",autofocus:"",autocomplete:"lastname"},null,8,["modelValue"]),t(i,{class:"mt-2",message:l(s).errors.lastname},null,8,["message"])]),o("div",null,[t(n,{for:"firstname"},{default:d(()=>e[21]||(e[21]=[u(" First Name "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"firstname",modelValue:l(s).firstname,"onUpdate:modelValue":e[1]||(e[1]=a=>l(s).firstname=a),type:"text",class:"mt-1 block w-full",autofocus:"",autocomplete:"firstname"},null,8,["modelValue"]),t(i,{class:"mt-2",message:l(s).errors.firstname},null,8,["message"])]),o("div",null,[t(n,{for:"middlename"},{default:d(()=>e[22]||(e[22]=[u(" Middle Name ")])),_:1}),t(m,{id:"middlename",modelValue:l(s).middlename,"onUpdate:modelValue":e[2]||(e[2]=a=>l(s).middlename=a),type:"text",class:"mt-1 block w-full",autocomplete:"middlename"},null,8,["modelValue"]),t(i,{class:"mt-2",message:l(s).errors.middlename},null,8,["message"])]),o("div",null,[t(n,{for:"email"},{default:d(()=>e[23]||(e[23]=[u(" Email Address "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"email",modelValue:l(s).email,"onUpdate:modelValue":e[3]||(e[3]=a=>l(s).email=a),type:"email",class:"mt-1 block w-full",required:"",autocomplete:"username"},null,8,["modelValue"]),t(i,{class:"mt-2",message:l(s).errors.email},null,8,["message"])]),o("div",null,[t(n,{for:"contact_number"},{default:d(()=>e[24]||(e[24]=[u(" Contact Number "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"contact_number",modelValue:l(s).contact_number,"onUpdate:modelValue":e[4]||(e[4]=a=>l(s).contact_number=a),type:"tel",class:"mt-1 block w-full",required:"",onInput:S,placeholder:"ex. 09xxxxxxxxx"},null,8,["modelValue"]),t(i,{class:"mt-2",message:l(s).errors.contact_number},null,8,["message"])]),_.value?D("",!0):(p(),c("div",ee,[t(n,{for:"password"},{default:d(()=>e[25]||(e[25]=[u(" Password "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"password",modelValue:l(s).password,"onUpdate:modelValue":e[5]||(e[5]=a=>l(s).password=a),type:"password",class:"mt-1 block w-full",required:"",autocomplete:"new-password"},null,8,["modelValue"]),t(i,{class:"mt-2",message:l(s).errors.password},null,8,["message"])])),_.value?D("",!0):(p(),c("div",se,[t(n,{for:"password_confirmation"},{default:d(()=>e[26]||(e[26]=[u(" Confirm Password "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"password_confirmation",modelValue:l(s).password_confirmation,"onUpdate:modelValue":e[6]||(e[6]=a=>l(s).password_confirmation=a),type:"password",class:"mt-1 block w-full",disabled:_.value,required:"",autocomplete:"new-password"},null,8,["modelValue","disabled"]),t(i,{class:"mt-2",message:l(s).errors.password_confirmation},null,8,["message"])])),o("div",null,[t(n,{for:"birthday"},{default:d(()=>e[27]||(e[27]=[u(" Birthday "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"birthday",modelValue:l(s).birthday,"onUpdate:modelValue":e[7]||(e[7]=a=>l(s).birthday=a),type:"date",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),t(i,{class:"mt-2",message:l(s).errors.birthday},null,8,["message"])]),o("div",null,[t(n,{for:"birthplace",value:"Birthplace"}),t(m,{id:"birthplace",modelValue:l(s).birthplace,"onUpdate:modelValue":e[8]||(e[8]=a=>l(s).birthplace=a),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),t(i,{class:"mt-2",message:l(s).errors.birthplace},null,8,["message"])]),o("div",null,[t(n,{for:"gender",value:"Gender"}),b(o("select",{id:"gender","onUpdate:modelValue":e[9]||(e[9]=a=>l(s).gender=a),class:"mt-1 block w-full"},e[28]||(e[28]=[o("option",{value:"",disabled:""},"Select Gender",-1),o("option",{value:"male"},"Male",-1),o("option",{value:"female"},"Female",-1),o("option",{value:"other"},"Other",-1)]),512),[[v,l(s).gender]]),t(i,{class:"mt-2",message:l(s).errors.gender},null,8,["message"])]),o("div",null,[t(n,{for:"marital_status",value:"Marital Status"}),b(o("select",{id:"marital_status","onUpdate:modelValue":e[10]||(e[10]=a=>l(s).marital_status=a),class:"mt-1 block w-full"},e[29]||(e[29]=[o("option",{value:"",disabled:""},"Select Marital Status",-1),o("option",{value:"single"},"Single",-1),o("option",{value:"married"},"Married",-1)]),512),[[v,l(s).marital_status]]),t(i,{class:"mt-2",message:l(s).errors.marital_status},null,8,["message"])]),o("div",null,[t(n,{for:"region_id"},{default:d(()=>e[30]||(e[30]=[u(" Region "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),b(o("select",{id:"region_id","onUpdate:modelValue":e[11]||(e[11]=a=>l(s).region_id=a),class:"mt-1 block w-full",required:""},[e[31]||(e[31]=o("option",{value:"",disabled:""},"Select Region",-1)),(p(!0),c(V,null,k($.value,a=>(p(),c("option",{key:a.region_id,value:a.region_id},w(a.region_name),9,le))),128))],512),[[v,l(s).region_id]]),t(i,{class:"mt-2",message:l(s).errors.region_id},null,8,["message"])]),o("div",null,[t(n,{for:"province_id"},{default:d(()=>e[32]||(e[32]=[u(" Province "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),b(o("select",{id:"province_id","onUpdate:modelValue":e[12]||(e[12]=a=>l(s).province_id=a),class:"mt-1 block w-full",required:""},[e[33]||(e[33]=o("option",{value:"",disabled:""},"Select Province",-1)),(p(!0),c(V,null,k(E.value,a=>(p(),c("option",{key:a.province_id,value:a.province_id},w(a.province_name),9,ae))),128))],512),[[v,l(s).province_id]]),t(i,{class:"mt-2",message:l(s).errors.province_id},null,8,["message"])]),o("div",null,[t(n,{for:"city_id"},{default:d(()=>e[34]||(e[34]=[u(" City ")])),_:1}),b(o("select",{id:"city_id","onUpdate:modelValue":e[13]||(e[13]=a=>l(s).city_id=a),class:"mt-1 block w-full"},[e[35]||(e[35]=o("option",{value:"",disabled:""},"Select City",-1)),(p(!0),c(V,null,k(x.value,a=>(p(),c("option",{key:a.city_id,value:a.city_id},w(a.city_name),9,re))),128))],512),[[v,l(s).city_id]]),t(i,{class:"mt-2",message:l(s).errors.city_id},null,8,["message"])]),o("div",null,[t(n,{for:"municipality_id"},{default:d(()=>e[36]||(e[36]=[u(" Municipality ")])),_:1}),b(o("select",{id:"municipality_id","onUpdate:modelValue":e[14]||(e[14]=a=>l(s).municipality_id=a),class:"mt-1 block w-full"},[e[37]||(e[37]=o("option",{value:"",disabled:""},"Select Municipality",-1)),(p(!0),c(V,null,k(U.value,a=>(p(),c("option",{key:a.municipality_id,value:a.municipality_id},w(a.municipality_name),9,te))),128))],512),[[v,l(s).municipality_id]]),t(i,{class:"mt-2",message:l(s).errors.municipality_id},null,8,["message"])]),o("div",null,[t(n,{for:"address_brgy"},{default:d(()=>e[38]||(e[38]=[u(" Barangay "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"address_brgy",modelValue:l(s).address_brgy,"onUpdate:modelValue":e[15]||(e[15]=a=>l(s).address_brgy=a),type:"text",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),t(i,{class:"mt-2",message:l(s).errors.address_brgy},null,8,["message"])]),o("div",null,[t(n,{for:"address_number"},{default:d(()=>e[39]||(e[39]=[u(" Block/House Number "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"address_number",modelValue:l(s).address_number,"onUpdate:modelValue":e[16]||(e[16]=a=>l(s).address_number=a),type:"text",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),t(i,{class:"mt-2",message:l(s).errors.address_number},null,8,["message"])]),o("div",null,[t(n,{for:"address_street"},{default:d(()=>e[40]||(e[40]=[u(" Street "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"address_street",modelValue:l(s).address_street,"onUpdate:modelValue":e[17]||(e[17]=a=>l(s).address_street=a),type:"text",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),t(i,{class:"mt-2",message:l(s).errors.address_street},null,8,["message"])]),o("div",null,[t(n,{for:"address_zipcode"},{default:d(()=>e[41]||(e[41]=[u(" Zipcode "),o("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(m,{id:"address_zipcode",modelValue:l(s).address_zipcode,"onUpdate:modelValue":e[18]||(e[18]=a=>l(s).address_zipcode=a),type:"text",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),t(i,{class:"mt-2",message:l(s).errors.address_zipcode},null,8,["message"])]),o("div",oe,[t(T,{class:O(["ms-4",{"opacity-25":l(s).processing}]),disabled:l(s).processing,onClick:Q},{default:d(()=>e[42]||(e[42]=[u(" Submit ")])),_:1},8,["class","disabled"]),t(T,{class:O(["ms-4",{"opacity-25":l(s).processing}]),disabled:l(s).processing,onClick:J},{default:d(()=>e[43]||(e[43]=[u(" Submit & Add Disease Profile ")])),_:1},8,["class","disabled"])])],32)]),_:1})],64))}},ye=P(de,[["__scopeId","data-v-98bec90f"]]);export{ye as default};
