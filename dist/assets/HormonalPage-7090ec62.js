import{Q as B,T as F,d as V,l as O,m as k,o as c,c as y,w as p,a as s,b as t,g as f,u as l,q as H,v as L,t as D,e as b,h as M,F as A,f as w,k as E}from"./app-42536e63.js";import{_ as r}from"./InputError-d893a523.js";import{_ as m}from"./InputLabel-ff26f500.js";import{_}from"./TextInput-d9580142.js";import{_ as I}from"./PrimaryButton-cd95b478.js";import R from"./Layout-1c104a2a.js";import{d as S}from"./index-189aeacd.js";import{_ as T}from"./_plugin-vue_export-helper-c27b6911.js";import"./DropdownLink-ed97a0d6.js";/* empty css                                                               */const j=["disabled"],q={value:"",disabled:"",selected:""},Q=["value"],z={key:0,class:"mt-2 text-sm text-red-600"},G={class:"flex items-center justify-center mt-4"},J={__name:"HormonalPage",setup(K){const{url:h}=B(),g=h.split("/");let d=g[g.length-1];d=parseInt(d,10),console.log("Patient ID:",d);let i;g.length===5&&(i=parseInt(g[3],10),d=parseInt(g[4],10));const e=F({lastname:"",email:"",hormonal_drug:"",hormonal_dose:"",hormonal_startDate:"",hormonal_endDate:"",hormonal_status:"",hormonal_notes:"",hormonal_doctor:""}),v=V(0),U=V([]),C=V(0);if(h){const n=new URL(h,window.location.origin);v.value=n.searchParams.get("currentStep")}else console.error("URL is undefined");const $=()=>{S.Inertia.visit(document.referrer)},x=async()=>{try{const a=(await k.get("/api/all-patients")).data.find(u=>u.patient_id===d);if(console.log("Found patient:",a),a){const u=a.user;e.lastname=u.lastname,e.email=u.email}}catch(n){console.error("Failed to fetch patient info:",n)}},N=async n=>{try{const a=(await k.get(`/api/patient/${n}/treatments`)).data;console.log(a),e.hormonal_drug=a.hormonals[i].hormonal_drugs,e.hormonal_dose=a.hormonals[i].hormonal_dose,e.hormonal_startDate=a.hormonals[i].hormonal_initial_date,e.hormonal_endDate=a.hormonals[i].hormonal_end_date,e.hormonal_status=a.hormonals[i].hormonal_status,e.hormonal_notes=a.hormonals[i].hormonal_notes,e.hormonal_doctor=a.hormonals[i].hormonal_doctor}catch(o){console.error("Failed to fetch patient:",o)}};O(async()=>{await x(),await N(d),k.get("/api/all-doctors").then(n=>{U.value=n.data}).catch(n=>{console.error(n)})});const P=()=>{console.log(e),e.post("/api/create-hormonal-record",{onSuccess:()=>{C.value===1?S.Inertia.visit(`/treatment-history/hormonal/${d}`):S.Inertia.visit(`/consult/${d}`)},onError:n=>{n.patient_id?error.value=n.patient_id[0]:console.log(n)}})};return(n,o)=>(c(),y(R,null,{default:p(()=>[o[17]||(o[17]=s("div",{class:"page-heading"},[s("h1",{class:"main-heading"},"HORMONAL")],-1)),s("form",{onSubmit:E(P,["prevent"]),class:"form-container"},[s("div",null,[t(m,{for:"lastname"},{default:p(()=>o[10]||(o[10]=[f(" Last Name "),s("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(_,{id:"lastname",modelValue:l(e).lastname,"onUpdate:modelValue":o[0]||(o[0]=a=>l(e).lastname=a),type:"text",class:"mt-1 block w-full",autofocus:"",autocomplete:"lastname"},null,8,["modelValue"]),t(r,{class:"mt-2",message:l(e).errors.lastname},null,8,["message"])]),s("div",null,[t(m,{for:"email"},{default:p(()=>o[11]||(o[11]=[f(" Email Address "),s("span",{class:"red-asterisk"},"*",-1)])),_:1}),t(_,{id:"email",modelValue:l(e).email,"onUpdate:modelValue":o[1]||(o[1]=a=>l(e).email=a),type:"email",class:"mt-1 block w-full",autocomplete:"username"},null,8,["modelValue"]),t(r,{class:"mt-2",message:l(e).errors.email},null,8,["message"])]),s("div",null,[t(m,{for:"hormonal_drug",value:"Hormonal Drug"}),t(_,{id:"hormonal_drug",modelValue:l(e).hormonal_drug,"onUpdate:modelValue":o[2]||(o[2]=a=>l(e).hormonal_drug=a),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),t(r,{message:l(e).errors.hormonal_drug},null,8,["message"])]),s("div",null,[t(m,{for:"hormonal_dose",value:"Hormonal Dose"}),t(_,{id:"hormonal_dose",modelValue:l(e).hormonal_dose,"onUpdate:modelValue":o[3]||(o[3]=a=>l(e).hormonal_dose=a),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),t(r,{class:"mt-2",message:l(e).errors.hormonal_dose},null,8,["message"])]),s("div",null,[t(m,{for:"hormonal_startDate",value:"Initial Hormonal Date"}),t(_,{id:"hormonal_startDate",modelValue:l(e).hormonal_startDate,"onUpdate:modelValue":o[4]||(o[4]=a=>l(e).hormonal_startDate=a),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),t(r,{class:"mt-2",message:l(e).errors.hormonal_startDate},null,8,["message"])]),s("div",null,[t(m,{for:"hormonal_endDate",value:"Last Hormonal Date"}),t(_,{id:"hormonal_endDate",modelValue:l(e).hormonal_endDate,"onUpdate:modelValue":o[5]||(o[5]=a=>l(e).hormonal_endDate=a),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),t(r,{class:"mt-2",message:l(e).errors.hormonal_endDate},null,8,["message"])]),s("div",null,[t(m,{for:"hormonal_status",value:"Hormonal Status"}),H(s("select",{id:"hormonal_status","onUpdate:modelValue":o[6]||(o[6]=a=>l(e).hormonal_status=a),class:"mt-1 block w-full"},o[12]||(o[12]=[s("option",{value:"",disabled:""},"Select Hormonal Status",-1),s("option",{value:"Ongoing"},"Ongoing",-1),s("option",{value:"Completed"},"Completed",-1),s("option",{value:"Not Completed"},"Not Completed",-1)]),512),[[L,l(e).hormonal_status]]),t(r,{class:"mt-2",message:l(e).errors.hormonal_status},null,8,["message"])]),s("div",null,[t(m,{for:"hormonal_notes",value:"Hormonal Notes"}),t(_,{id:"hormonal_notes",modelValue:l(e).hormonal_notes,"onUpdate:modelValue":o[7]||(o[7]=a=>l(e).hormonal_notes=a),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),t(r,{class:"mt-2",message:l(e).errors.hormonal_notes},null,8,["message"])]),s("div",null,[t(m,{for:"hormonal_doctor"},{default:p(()=>o[13]||(o[13]=[f(" Hormonal Doctor ")])),_:1}),H(s("select",{id:"hormonal_doctor","onUpdate:modelValue":o[8]||(o[8]=a=>l(e).hormonal_doctor=a),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:"",disabled:n.isLoading},[s("option",q,D(n.isLoading?"Loading doctors...":"Select a Doctor"),1),(c(!0),b(A,null,M(U.value,a=>(c(),b("option",{key:a.doctor_id,value:a.doctor_id},D("Dr. "+`${a.user.firstname} ${a.user.middlename} ${a.user.lastname}`.toLowerCase().split(" ").map(u=>u.charAt(0).toUpperCase()+u.slice(1)).join(" ")),9,Q))),128))],8,j),[[L,l(e).hormonal_doctor]]),t(r,{class:"mt-2",message:l(e).errors.hormonal_doctor},null,8,["message"]),n.error?(c(),b("p",z,D(n.error),1)):w("",!0)]),s("div",G,[v.value?(c(),y(I,{key:0,onClick:$,class:"ms-4"},{default:p(()=>o[14]||(o[14]=[f(" Back ")])),_:1})):w("",!0),v.value?w("",!0):(c(),y(I,{key:1,onClick:o[9]||(o[9]=a=>C.value=1),class:"ms-4"},{default:p(()=>o[15]||(o[15]=[f(" Submit ")])),_:1})),t(I,{onClick:n.nextStep,class:"ms-4"},{default:p(()=>o[16]||(o[16]=[f(" Submit and Proceed ")])),_:1},8,["onClick"])])],32)]),_:1}))}},no=T(J,[["__scopeId","data-v-97d91271"]]);export{no as default};
